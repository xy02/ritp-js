!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ritp_js=e():t.ritp_js=e()}(this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=20)}([function(t,e,r){"use strict";var n,o=r(4),i=o.Reader,s=o.Writer,u=o.util,c=o.roots.default||(o.roots.default={});c.ritp=((n={}).Frame=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}var e;return t.prototype.info=null,t.prototype.close=null,t.prototype.pull=0,t.prototype.msg=null,Object.defineProperty(t.prototype,"type",{get:u.oneOfGetter(e=["info","close","pull","msg"]),set:u.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.info&&Object.hasOwnProperty.call(t,"info")&&c.ritp.Info.encode(t.info,e.uint32(10).fork()).ldelim(),null!=t.close&&Object.hasOwnProperty.call(t,"close")&&c.ritp.Close.encode(t.close,e.uint32(18).fork()).ldelim(),null!=t.pull&&Object.hasOwnProperty.call(t,"pull")&&e.uint32(24).uint32(t.pull),null!=t.msg&&Object.hasOwnProperty.call(t,"msg")&&c.ritp.Msg.encode(t.msg,e.uint32(34).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.Frame;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.info=c.ritp.Info.decode(t,t.uint32());break;case 2:n.close=c.ritp.Close.decode(t,t.uint32());break;case 3:n.pull=t.uint32();break;case 4:n.msg=c.ritp.Msg.decode(t,t.uint32());break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.info&&t.hasOwnProperty("info")&&(e.type=1,r=c.ritp.Info.verify(t.info)))return"info."+r;if(null!=t.close&&t.hasOwnProperty("close")){if(1===e.type)return"type: multiple values";if(e.type=1,r=c.ritp.Close.verify(t.close))return"close."+r}if(null!=t.pull&&t.hasOwnProperty("pull")){if(1===e.type)return"type: multiple values";if(e.type=1,!u.isInteger(t.pull))return"pull: integer expected"}if(null!=t.msg&&t.hasOwnProperty("msg")){if(1===e.type)return"type: multiple values";var r;if(e.type=1,r=c.ritp.Msg.verify(t.msg))return"msg."+r}return null},t.fromObject=function(t){if(t instanceof c.ritp.Frame)return t;var e=new c.ritp.Frame;if(null!=t.info){if("object"!=typeof t.info)throw TypeError(".ritp.Frame.info: object expected");e.info=c.ritp.Info.fromObject(t.info)}if(null!=t.close){if("object"!=typeof t.close)throw TypeError(".ritp.Frame.close: object expected");e.close=c.ritp.Close.fromObject(t.close)}if(null!=t.pull&&(e.pull=t.pull>>>0),null!=t.msg){if("object"!=typeof t.msg)throw TypeError(".ritp.Frame.msg: object expected");e.msg=c.ritp.Msg.fromObject(t.msg)}return e},t.toObject=function(t,e){e||(e={});var r={};return null!=t.info&&t.hasOwnProperty("info")&&(r.info=c.ritp.Info.toObject(t.info,e),e.oneofs&&(r.type="info")),null!=t.close&&t.hasOwnProperty("close")&&(r.close=c.ritp.Close.toObject(t.close,e),e.oneofs&&(r.type="close")),null!=t.pull&&t.hasOwnProperty("pull")&&(r.pull=t.pull,e.oneofs&&(r.type="pull")),null!=t.msg&&t.hasOwnProperty("msg")&&(r.msg=c.ritp.Msg.toObject(t.msg,e),e.oneofs&&(r.type="msg")),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),n.Info=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return t.prototype.version="",t.prototype.data=u.newBuffer([]),t.prototype.dataType="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.version&&Object.hasOwnProperty.call(t,"version")&&e.uint32(10).string(t.version),null!=t.data&&Object.hasOwnProperty.call(t,"data")&&e.uint32(18).bytes(t.data),null!=t.dataType&&Object.hasOwnProperty.call(t,"dataType")&&e.uint32(26).string(t.dataType),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.Info;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.version=t.string();break;case 2:n.data=t.bytes();break;case 3:n.dataType=t.string();break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.version&&t.hasOwnProperty("version")&&!u.isString(t.version)?"version: string expected":null!=t.data&&t.hasOwnProperty("data")&&!(t.data&&"number"==typeof t.data.length||u.isString(t.data))?"data: buffer expected":null!=t.dataType&&t.hasOwnProperty("dataType")&&!u.isString(t.dataType)?"dataType: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.Info)return t;var e=new c.ritp.Info;return null!=t.version&&(e.version=String(t.version)),null!=t.data&&("string"==typeof t.data?u.base64.decode(t.data,e.data=u.newBuffer(u.base64.length(t.data)),0):t.data.length&&(e.data=t.data)),null!=t.dataType&&(e.dataType=String(t.dataType)),e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.version="",e.bytes===String?r.data="":(r.data=[],e.bytes!==Array&&(r.data=u.newBuffer(r.data))),r.dataType=""),null!=t.version&&t.hasOwnProperty("version")&&(r.version=t.version),null!=t.data&&t.hasOwnProperty("data")&&(r.data=e.bytes===String?u.base64.encode(t.data,0,t.data.length):e.bytes===Array?Array.prototype.slice.call(t.data):t.data),null!=t.dataType&&t.hasOwnProperty("dataType")&&(r.dataType=t.dataType),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),n.Close=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}var e,r;return t.prototype.reason=0,t.prototype.message="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.reason&&Object.hasOwnProperty.call(t,"reason")&&e.uint32(8).int32(t.reason),null!=t.message&&Object.hasOwnProperty.call(t,"message")&&e.uint32(18).string(t.message),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.Close;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.reason=t.int32();break;case 2:n.message=t.string();break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.reason&&t.hasOwnProperty("reason"))switch(t.reason){default:return"reason: enum value expected";case 0:case 1:}return null!=t.message&&t.hasOwnProperty("message")&&!u.isString(t.message)?"message: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.Close)return t;var e=new c.ritp.Close;switch(t.reason){case"APPLICATION_ERROR":case 0:e.reason=0;break;case"PROTOCOL_ERROR":case 1:e.reason=1}return null!=t.message&&(e.message=String(t.message)),e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.reason=e.enums===String?"APPLICATION_ERROR":0,r.message=""),null!=t.reason&&t.hasOwnProperty("reason")&&(r.reason=e.enums===String?c.ritp.Close.Reason[t.reason]:t.reason),null!=t.message&&t.hasOwnProperty("message")&&(r.message=t.message),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t.Reason=(e={},(r=Object.create(e))[e[0]="APPLICATION_ERROR"]=0,r[e[1]="PROTOCOL_ERROR"]=1,r),t}(),n.Msg=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}var e;return t.prototype.streamId=0,t.prototype.header=null,t.prototype.close=null,t.prototype.pull=0,t.prototype.buf=u.newBuffer([]),t.prototype.end=null,Object.defineProperty(t.prototype,"type",{get:u.oneOfGetter(e=["header","close","pull","buf","end"]),set:u.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.streamId&&Object.hasOwnProperty.call(t,"streamId")&&e.uint32(8).uint32(t.streamId),null!=t.header&&Object.hasOwnProperty.call(t,"header")&&c.ritp.Header.encode(t.header,e.uint32(18).fork()).ldelim(),null!=t.close&&Object.hasOwnProperty.call(t,"close")&&c.ritp.Close.encode(t.close,e.uint32(26).fork()).ldelim(),null!=t.pull&&Object.hasOwnProperty.call(t,"pull")&&e.uint32(32).uint32(t.pull),null!=t.buf&&Object.hasOwnProperty.call(t,"buf")&&e.uint32(42).bytes(t.buf),null!=t.end&&Object.hasOwnProperty.call(t,"end")&&c.ritp.End.encode(t.end,e.uint32(50).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.Msg;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.streamId=t.uint32();break;case 2:n.header=c.ritp.Header.decode(t,t.uint32());break;case 3:n.close=c.ritp.Close.decode(t,t.uint32());break;case 4:n.pull=t.uint32();break;case 5:n.buf=t.bytes();break;case 6:n.end=c.ritp.End.decode(t,t.uint32());break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.streamId&&t.hasOwnProperty("streamId")&&!u.isInteger(t.streamId))return"streamId: integer expected";if(null!=t.header&&t.hasOwnProperty("header")&&(e.type=1,r=c.ritp.Header.verify(t.header)))return"header."+r;if(null!=t.close&&t.hasOwnProperty("close")){if(1===e.type)return"type: multiple values";if(e.type=1,r=c.ritp.Close.verify(t.close))return"close."+r}if(null!=t.pull&&t.hasOwnProperty("pull")){if(1===e.type)return"type: multiple values";if(e.type=1,!u.isInteger(t.pull))return"pull: integer expected"}if(null!=t.buf&&t.hasOwnProperty("buf")){if(1===e.type)return"type: multiple values";if(e.type=1,!(t.buf&&"number"==typeof t.buf.length||u.isString(t.buf)))return"buf: buffer expected"}if(null!=t.end&&t.hasOwnProperty("end")){if(1===e.type)return"type: multiple values";var r;if(e.type=1,r=c.ritp.End.verify(t.end))return"end."+r}return null},t.fromObject=function(t){if(t instanceof c.ritp.Msg)return t;var e=new c.ritp.Msg;if(null!=t.streamId&&(e.streamId=t.streamId>>>0),null!=t.header){if("object"!=typeof t.header)throw TypeError(".ritp.Msg.header: object expected");e.header=c.ritp.Header.fromObject(t.header)}if(null!=t.close){if("object"!=typeof t.close)throw TypeError(".ritp.Msg.close: object expected");e.close=c.ritp.Close.fromObject(t.close)}if(null!=t.pull&&(e.pull=t.pull>>>0),null!=t.buf&&("string"==typeof t.buf?u.base64.decode(t.buf,e.buf=u.newBuffer(u.base64.length(t.buf)),0):t.buf.length&&(e.buf=t.buf)),null!=t.end){if("object"!=typeof t.end)throw TypeError(".ritp.Msg.end: object expected");e.end=c.ritp.End.fromObject(t.end)}return e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.streamId=0),null!=t.streamId&&t.hasOwnProperty("streamId")&&(r.streamId=t.streamId),null!=t.header&&t.hasOwnProperty("header")&&(r.header=c.ritp.Header.toObject(t.header,e),e.oneofs&&(r.type="header")),null!=t.close&&t.hasOwnProperty("close")&&(r.close=c.ritp.Close.toObject(t.close,e),e.oneofs&&(r.type="close")),null!=t.pull&&t.hasOwnProperty("pull")&&(r.pull=t.pull,e.oneofs&&(r.type="pull")),null!=t.buf&&t.hasOwnProperty("buf")&&(r.buf=e.bytes===String?u.base64.encode(t.buf,0,t.buf.length):e.bytes===Array?Array.prototype.slice.call(t.buf):t.buf,e.oneofs&&(r.type="buf")),null!=t.end&&t.hasOwnProperty("end")&&(r.end=c.ritp.End.toObject(t.end,e),e.oneofs&&(r.type="end")),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),n.Header=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}return t.prototype.fn="",t.prototype.data=u.newBuffer([]),t.prototype.dataType="",t.prototype.bufType="",t.prototype.outputTo="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.fn&&Object.hasOwnProperty.call(t,"fn")&&e.uint32(10).string(t.fn),null!=t.data&&Object.hasOwnProperty.call(t,"data")&&e.uint32(18).bytes(t.data),null!=t.dataType&&Object.hasOwnProperty.call(t,"dataType")&&e.uint32(26).string(t.dataType),null!=t.bufType&&Object.hasOwnProperty.call(t,"bufType")&&e.uint32(34).string(t.bufType),null!=t.outputTo&&Object.hasOwnProperty.call(t,"outputTo")&&e.uint32(42).string(t.outputTo),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.Header;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.fn=t.string();break;case 2:n.data=t.bytes();break;case 3:n.dataType=t.string();break;case 4:n.bufType=t.string();break;case 5:n.outputTo=t.string();break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.fn&&t.hasOwnProperty("fn")&&!u.isString(t.fn)?"fn: string expected":null!=t.data&&t.hasOwnProperty("data")&&!(t.data&&"number"==typeof t.data.length||u.isString(t.data))?"data: buffer expected":null!=t.dataType&&t.hasOwnProperty("dataType")&&!u.isString(t.dataType)?"dataType: string expected":null!=t.bufType&&t.hasOwnProperty("bufType")&&!u.isString(t.bufType)?"bufType: string expected":null!=t.outputTo&&t.hasOwnProperty("outputTo")&&!u.isString(t.outputTo)?"outputTo: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.Header)return t;var e=new c.ritp.Header;return null!=t.fn&&(e.fn=String(t.fn)),null!=t.data&&("string"==typeof t.data?u.base64.decode(t.data,e.data=u.newBuffer(u.base64.length(t.data)),0):t.data.length&&(e.data=t.data)),null!=t.dataType&&(e.dataType=String(t.dataType)),null!=t.bufType&&(e.bufType=String(t.bufType)),null!=t.outputTo&&(e.outputTo=String(t.outputTo)),e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.fn="",e.bytes===String?r.data="":(r.data=[],e.bytes!==Array&&(r.data=u.newBuffer(r.data))),r.dataType="",r.bufType="",r.outputTo=""),null!=t.fn&&t.hasOwnProperty("fn")&&(r.fn=t.fn),null!=t.data&&t.hasOwnProperty("data")&&(r.data=e.bytes===String?u.base64.encode(t.data,0,t.data.length):e.bytes===Array?Array.prototype.slice.call(t.data):t.data),null!=t.dataType&&t.hasOwnProperty("dataType")&&(r.dataType=t.dataType),null!=t.bufType&&t.hasOwnProperty("bufType")&&(r.bufType=t.bufType),null!=t.outputTo&&t.hasOwnProperty("outputTo")&&(r.outputTo=t.outputTo),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),n.End=function(){function t(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)null!=t[e[r]]&&(this[e[r]]=t[e[r]])}var e,r;return t.prototype.reason=0,t.prototype.message="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.reason&&Object.hasOwnProperty.call(t,"reason")&&e.uint32(8).int32(t.reason),null!=t.message&&Object.hasOwnProperty.call(t,"message")&&e.uint32(18).string(t.message),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var r=void 0===e?t.len:t.pos+e,n=new c.ritp.End;t.pos<r;){var o=t.uint32();switch(o>>>3){case 1:n.reason=t.int32();break;case 2:n.message=t.string();break;default:t.skipType(7&o)}}return n},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.reason&&t.hasOwnProperty("reason"))switch(t.reason){default:return"reason: enum value expected";case 0:case 1:}return null!=t.message&&t.hasOwnProperty("message")&&!u.isString(t.message)?"message: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.End)return t;var e=new c.ritp.End;switch(t.reason){case"COMPLETE":case 0:e.reason=0;break;case"CANCEL":case 1:e.reason=1}return null!=t.message&&(e.message=String(t.message)),e},t.toObject=function(t,e){e||(e={});var r={};return e.defaults&&(r.reason=e.enums===String?"COMPLETE":0,r.message=""),null!=t.reason&&t.hasOwnProperty("reason")&&(r.reason=e.enums===String?c.ritp.End.Reason[t.reason]:t.reason),null!=t.message&&t.hasOwnProperty("message")&&(r.message=t.message),r},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t.Reason=(e={},(r=Object.create(e))[e[0]="COMPLETE"]=0,r[e[1]="CANCEL"]=1,r),t}(),n),t.exports=c},function(t,e,r){"use strict";(function(t){var n=e;function o(t,e,r){for(var n=Object.keys(e),o=0;o<n.length;++o)void 0!==t[n[o]]&&r||(t[n[o]]=e[n[o]]);return t}function i(t){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&o(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}n.asPromise=r(7),n.base64=r(8),n.EventEmitter=r(9),n.float=r(10),n.inquire=r(11),n.utf8=r(12),n.pool=r(13),n.LongBits=r(14),n.isNode=Boolean(void 0!==t&&t&&t.process&&t.process.versions&&t.process.versions.node),n.global=n.isNode&&t||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isString=function(t){return"string"==typeof t||t instanceof String},n.isObject=function(t){return t&&"object"==typeof t},n.isset=n.isSet=function(t,e){var r=t[e];return!(null==r||!t.hasOwnProperty(e))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var t=n.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(t){return"number"==typeof t?n.Buffer?n._Buffer_allocUnsafe(t):new n.Array(t):n.Buffer?n._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(t){return t?n.LongBits.from(t).toHash():n.LongBits.zeroHash},n.longFromHash=function(t,e){var r=n.LongBits.fromHash(t);return n.Long?n.Long.fromBits(r.lo,r.hi,e):r.toNumber(Boolean(e))},n.merge=o,n.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},n.newError=i,n.ProtocolError=i("ProtocolError"),n.oneOfGetter=function(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=1;return function(){for(var t=Object.keys(this),r=t.length-1;r>-1;--r)if(1===e[t[r]]&&void 0!==this[t[r]]&&null!==this[t[r]])return t[r]}},n.oneOfSetter=function(t){return function(e){for(var r=0;r<t.length;++r)t[r]!==e&&delete this[t[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var t=n.Buffer;t?(n._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,r){return new t(e,r)},n._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):n._Buffer_from=n._Buffer_allocUnsafe=null}}).call(this,r(6))},function(t,e,r){"use strict";t.exports=f;var n,o=r(1),i=o.LongBits,s=o.base64,u=o.utf8;function c(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function a(){}function l(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function f(){this.len=0,this.head=new c(a,0,0),this.tail=this.head,this.states=null}var p=function(){return o.Buffer?function(){return(f.create=function(){return new n})()}:function(){return new f}};function h(t,e,r){e[r]=255&t}function d(t,e){this.len=t,this.next=void 0,this.val=e}function y(t,e,r){for(;t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function b(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}f.create=p(),f.alloc=function(t){return new o.Array(t)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(t,e,r){return this.tail=this.tail.next=new c(t,e,r),this.len+=e,this},d.prototype=Object.create(c.prototype),d.prototype.fn=function(t,e,r){for(;t>127;)e[r++]=127&t|128,t>>>=7;e[r]=t},f.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new d((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},f.prototype.int32=function(t){return t<0?this._push(y,10,i.fromNumber(t)):this.uint32(t)},f.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},f.prototype.uint64=function(t){var e=i.from(t);return this._push(y,e.length(),e)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(t){var e=i.from(t).zzEncode();return this._push(y,e.length(),e)},f.prototype.bool=function(t){return this._push(h,1,t?1:0)},f.prototype.fixed32=function(t){return this._push(b,4,t>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(t){var e=i.from(t);return this._push(b,4,e.lo)._push(b,4,e.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(t){return this._push(o.float.writeFloatLE,4,t)},f.prototype.double=function(t){return this._push(o.float.writeDoubleLE,8,t)};var v=o.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var n=0;n<t.length;++n)e[r+n]=t[n]};f.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(h,1,0);if(o.isString(t)){var r=f.alloc(e=s.length(t));s.decode(t,r,0),t=r}return this.uint32(e)._push(v,e,t)},f.prototype.string=function(t){var e=u.length(t);return e?this.uint32(e)._push(u.write,e,t):this._push(h,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(a,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(a,0,0),this.len=0),this},f.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this},f.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e},f._configure=function(t){n=t,f.create=p(),n._configure()}},function(t,e,r){"use strict";t.exports=c;var n,o=r(1),i=o.LongBits,s=o.utf8;function u(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function c(t){this.buf=t,this.pos=0,this.len=t.length}var a,l="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new c(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new c(t);throw Error("illegal buffer")},f=function(){return o.Buffer?function(t){return(c.create=function(t){return o.Buffer.isBuffer(t)?new n(t):l(t)})(t)}:l};function p(){var t=new i(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw u(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw u(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function h(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw u(this,8);return new i(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(a=4294967295,function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return a;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return a}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var t=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},c.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var t=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},c.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw u(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,r):e===r?new this.buf.constructor(0):this._slice.call(this.buf,e,r)},c.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},c.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw u(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw u(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},c._configure=function(t){n=t,c.create=f(),n._configure();var e=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return p.call(this)[e](!1)},uint64:function(){return p.call(this)[e](!0)},sint64:function(){return p.call(this).zzDecode()[e](!1)},fixed64:function(){return d.call(this)[e](!0)},sfixed64:function(){return d.call(this)[e](!1)}})}},function(t,e,r){"use strict";t.exports=r(5)},function(t,e,r){"use strict";var n=e;function o(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(2),n.BufferWriter=r(15),n.Reader=r(3),n.BufferReader=r(16),n.util=r(1),n.rpc=r(17),n.roots=r(19),n.configure=o,o()},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";t.exports=function(t,e){var r=new Array(arguments.length-1),n=0,o=2,i=!0;for(;o<arguments.length;)r[n++]=arguments[o++];return new Promise((function(o,s){r[n]=function(t){if(i)if(i=!1,t)s(t);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];o.apply(null,e)}};try{t.apply(e||null,r)}catch(t){i&&(i=!1,s(t))}}))}},function(t,e,r){"use strict";var n=e;n.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;--e%4>1&&"="===t.charAt(e);)++r;return Math.ceil(3*t.length)/4-r};for(var o=new Array(64),i=new Array(123),s=0;s<64;)i[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function(t,e,r){for(var n,i=null,s=[],u=0,c=0;e<r;){var a=t[e++];switch(c){case 0:s[u++]=o[a>>2],n=(3&a)<<4,c=1;break;case 1:s[u++]=o[n|a>>4],n=(15&a)<<2,c=2;break;case 2:s[u++]=o[n|a>>6],s[u++]=o[63&a],c=0}u>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),u=0)}return c&&(s[u++]=o[n],s[u++]=61,1===c&&(s[u++]=61)),i?(u&&i.push(String.fromCharCode.apply(String,s.slice(0,u))),i.join("")):String.fromCharCode.apply(String,s.slice(0,u))};n.decode=function(t,e,r){for(var n,o=r,s=0,u=0;u<t.length;){var c=t.charCodeAt(u++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:n=c,s=1;break;case 1:e[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:e[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:e[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return r-o},n.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},function(t,e,r){"use strict";function n(){this._listeners={}}t.exports=n,n.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this},n.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var r=this._listeners[t],n=0;n<r.length;)r[n].fn===e?r.splice(n,1):++n;return this},n.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<e.length;)e[n].fn.apply(e[n++].ctx,r)}return this}},function(t,e,r){"use strict";function n(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=128===r[3];function o(t,n,o){e[0]=t,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3]}function i(t,n,o){e[0]=t,n[o]=r[3],n[o+1]=r[2],n[o+2]=r[1],n[o+3]=r[0]}function s(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],e[0]}function u(t,n){return r[3]=t[n],r[2]=t[n+1],r[1]=t[n+2],r[0]=t[n+3],e[0]}t.writeFloatLE=n?o:i,t.writeFloatBE=n?i:o,t.readFloatLE=n?s:u,t.readFloatBE=n?u:s}():function(){function e(t,e,r,n){var o=e<0?1:0;if(o&&(e=-e),0===e)t(1/e>0?0:2147483648,r,n);else if(isNaN(e))t(2143289344,r,n);else if(e>34028234663852886e22)t((o<<31|2139095040)>>>0,r,n);else if(e<11754943508222875e-54)t((o<<31|Math.round(e/1401298464324817e-60))>>>0,r,n);else{var i=Math.floor(Math.log(e)/Math.LN2);t((o<<31|i+127<<23|8388607&Math.round(e*Math.pow(2,-i)*8388608))>>>0,r,n)}}function r(t,e,r){var n=t(e,r),o=2*(n>>31)+1,i=n>>>23&255,s=8388607&n;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}t.writeFloatLE=e.bind(null,o),t.writeFloatBE=e.bind(null,i),t.readFloatLE=r.bind(null,s),t.readFloatBE=r.bind(null,u)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=128===r[7];function o(t,n,o){e[0]=t,n[o]=r[0],n[o+1]=r[1],n[o+2]=r[2],n[o+3]=r[3],n[o+4]=r[4],n[o+5]=r[5],n[o+6]=r[6],n[o+7]=r[7]}function i(t,n,o){e[0]=t,n[o]=r[7],n[o+1]=r[6],n[o+2]=r[5],n[o+3]=r[4],n[o+4]=r[3],n[o+5]=r[2],n[o+6]=r[1],n[o+7]=r[0]}function s(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],r[4]=t[n+4],r[5]=t[n+5],r[6]=t[n+6],r[7]=t[n+7],e[0]}function u(t,n){return r[7]=t[n],r[6]=t[n+1],r[5]=t[n+2],r[4]=t[n+3],r[3]=t[n+4],r[2]=t[n+5],r[1]=t[n+6],r[0]=t[n+7],e[0]}t.writeDoubleLE=n?o:i,t.writeDoubleBE=n?i:o,t.readDoubleLE=n?s:u,t.readDoubleBE=n?u:s}():function(){function e(t,e,r,n,o,i){var s=n<0?1:0;if(s&&(n=-n),0===n)t(0,o,i+e),t(1/n>0?0:2147483648,o,i+r);else if(isNaN(n))t(0,o,i+e),t(2146959360,o,i+r);else if(n>17976931348623157e292)t(0,o,i+e),t((s<<31|2146435072)>>>0,o,i+r);else{var u;if(n<22250738585072014e-324)t((u=n/5e-324)>>>0,o,i+e),t((s<<31|u/4294967296)>>>0,o,i+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),t(4503599627370496*(u=n*Math.pow(2,-c))>>>0,o,i+e),t((s<<31|c+1023<<20|1048576*u&1048575)>>>0,o,i+r)}}}function r(t,e,r,n,o){var i=t(n,o+e),s=t(n,o+r),u=2*(s>>31)+1,c=s>>>20&2047,a=4294967296*(1048575&s)+i;return 2047===c?a?NaN:u*(1/0):0===c?5e-324*u*a:u*Math.pow(2,c-1075)*(a+4503599627370496)}t.writeDoubleLE=e.bind(null,o,0,4),t.writeDoubleBE=e.bind(null,i,4,0),t.readDoubleLE=r.bind(null,s,0,4),t.readDoubleBE=r.bind(null,u,4,0)}(),t}function o(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function i(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t}function s(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function u(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=n(n)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},function(t,e,r){"use strict";var n=e;n.length=function(t){for(var e=0,r=0,n=0;n<t.length;++n)(r=t.charCodeAt(n))<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e},n.read=function(t,e,r){if(r-e<1)return"";for(var n,o=null,i=[],s=0;e<r;)(n=t[e++])<128?i[s++]=n:n>191&&n<224?i[s++]=(31&n)<<6|63&t[e++]:n>239&&n<365?(n=((7&n)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,i[s++]=55296+(n>>10),i[s++]=56320+(1023&n)):i[s++]=(15&n)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},n.write=function(t,e,r){for(var n,o,i=r,s=0;s<t.length;++s)(n=t.charCodeAt(s))<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(o=t.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&o),++s,e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128);return r-i}},function(t,e,r){"use strict";t.exports=function(t,e,r){var n=r||8192,o=n>>>1,i=null,s=n;return function(r){if(r<1||r>o)return t(r);s+r>n&&(i=t(n),s=0);var u=e.call(i,s,s+=r);return 7&s&&(s=1+(7|s)),u}}},function(t,e,r){"use strict";t.exports=o;var n=r(1);function o(t,e){this.lo=t>>>0,this.hi=e>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(t){if(0===t)return i;var e=t<0;e&&(t=-t);var r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new o(r,n)},o.from=function(t){if("number"==typeof t)return o.fromNumber(t);if(n.isString(t)){if(!n.Long)return o.fromNumber(parseInt(t,10));t=n.Long.fromString(t)}return t.low||t.high?new o(t.low>>>0,t.high>>>0):i},o.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+4294967296*r)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(t){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var u=String.prototype.charCodeAt;o.fromHash=function(t){return t===s?i:new o((u.call(t,0)|u.call(t,1)<<8|u.call(t,2)<<16|u.call(t,3)<<24)>>>0,(u.call(t,4)|u.call(t,5)<<8|u.call(t,6)<<16|u.call(t,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},o.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},o.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}},function(t,e,r){"use strict";t.exports=i;var n=r(2);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(1);function i(){n.call(this)}function s(t,e,r){t.length<40?o.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var n=0;n<t.length;)e[r++]=t[n++]}},i.prototype.bytes=function(t){o.isString(t)&&(t=o._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(i.writeBytesBuffer,e,t),this},i.prototype.string=function(t){var e=o.Buffer.byteLength(t);return this.uint32(e),e&&this._push(s,e,t),this},i._configure()},function(t,e,r){"use strict";t.exports=i;var n=r(3);(i.prototype=Object.create(n.prototype)).constructor=i;var o=r(1);function i(t){n.call(this,t)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},i._configure()},function(t,e,r){"use strict";e.Service=r(18)},function(t,e,r){"use strict";t.exports=o;var n=r(1);function o(t,e,r){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}(o.prototype=Object.create(n.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function t(e,r,o,i,s){if(!i)throw TypeError("request must be specified");var u=this;if(!s)return n.asPromise(t,u,e,r,o,i);if(u.rpcImpl)try{return u.rpcImpl(e,r[u.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(t,r){if(t)return u.emit("error",t,e),s(t);if(null!==r){if(!(r instanceof o))try{r=o[u.responseDelimited?"decodeDelimited":"decode"](r)}catch(t){return u.emit("error",t,e),s(t)}return u.emit("data",r,e),s(null,r)}u.end(!0)}))}catch(t){return u.emit("error",t,e),void setTimeout((function(){s(t)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(t,e,r){"use strict";t.exports={}},function(t,e,r){"use strict";r.r(e),r.d(e,"getUint8ArrayFromStr",(function(){return ye})),r.d(e,"fromH5WebSocket",(function(){return be})),r.d(e,"initWith",(function(){return _e}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t){return"function"==typeof t}var s=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function c(t){setTimeout((function(){throw t}),0)}var a={closed:!0,next:function(t){},error:function(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete:function(){}},l=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function f(t){return null!==t&&"object"==typeof t}var p=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),h=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this._parentOrParents,n=this._ctorUnsubscribe,o=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var u=0;u<r.length;++u){r[u].remove(this)}if(i(o)){n&&(this._unsubscribe=void 0);try{o.call(this)}catch(t){e=t instanceof p?d(t.errors):[t]}}if(l(s)){u=-1;for(var c=s.length;++u<c;){var a=s[u];if(f(a))try{a.unsubscribe()}catch(t){e=e||[],t instanceof p?e=e.concat(d(t.errors)):e.push(t)}}}if(e)throw new p(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof t){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function d(t){return t.reduce((function(t,e){return t.concat(e instanceof p?e.errors:e)}),[])}var y=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(t){function e(r,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=a;break;case 1:if(!r){i.destination=a;break}if("object"==typeof r){r instanceof e?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new v(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new v(i,r,n,o)}return i}return o(e,t),e.prototype[y]=function(){return this},e.create=function(t,r,n){var o=new e(t,r,n);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(h),v=function(t){function e(e,r,n,o){var s,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return i(r)?s=r:r&&(s=r.next,n=r.error,o=r.complete,r!==a&&(i((c=Object.create(r)).unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=n,u._complete=o,u}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=u.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;c(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw t;c(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(c(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(b);var m=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function g(t){return t}function w(t){return 0===t.length?g:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var _=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof b)return t;if(t[y])return t[y]()}return t||e||r?new b(t,e,r):new b(a)}(t,e,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||u.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),u.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof b?n:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=O(e))((function(e,n){var o;o=r.subscribe((function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}}),n,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[m]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:w(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=O(t))((function(t,r){var n;e.subscribe((function(t){return n=t}),(function(t){return r(t)}),(function(){return t(n)}))}))},t.create=function(e){return new t(e)},t}();function O(t){if(t||(t=u.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var x=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),E=function(t){function e(e,r){var n=t.call(this)||this;return n.subject=e,n.subscriber=r,n.closed=!1,n}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(h),S=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return o(e,t),e}(b),T=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[y]=function(){return new S(this)},e.prototype.lift=function(t){var e=new j(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new x;if(!this.isStopped)for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new x;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,n=e.slice(),o=0;o<r;o++)n[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new x;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),n=0;n<e;n++)r[n].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new x;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new x;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new E(this,t))},e.prototype.asObservable=function(){var t=new _;return t.source=this,t},e.create=function(t,e){return new j(t,e)},e}(_),j=function(t){function e(e,r){var n=t.call(this)||this;return n.destination=e,n.source=r,n}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):h.EMPTY},e}(T);function P(t,e){return new _(e?function(r){return e.schedule(I,0,{error:t,subscriber:r})}:function(e){return e.error(t)})}function I(t){var e=t.error;t.subscriber.error(e)}var N=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}};function A(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var C=A(),k=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function B(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var M=function(t){if(t&&"function"==typeof t[m])return n=t,function(t){var e=n[m]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(k(t))return N(t);if(B(t))return r=t,function(t){return r.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,c),t};if(t&&"function"==typeof t[C])return e=t,function(t){for(var r=e[C]();;){var n=void 0;try{n=r.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof r.return&&t.add((function(){r.return&&r.return()})),t};var e,r,n,o=f(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function R(t,e){return new _((function(r){var n=new h,o=0;return n.add(e.schedule((function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}function L(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[m]}(t))return function(t,e){return new _((function(r){var n=new h;return n.add(e.schedule((function(){var o=t[m]();n.add(o.subscribe({next:function(t){n.add(e.schedule((function(){return r.next(t)})))},error:function(t){n.add(e.schedule((function(){return r.error(t)})))},complete:function(){n.add(e.schedule((function(){return r.complete()})))}}))}))),n}))}(t,e);if(B(t))return function(t,e){return new _((function(r){var n=new h;return n.add(e.schedule((function(){return t.then((function(t){n.add(e.schedule((function(){r.next(t),n.add(e.schedule((function(){return r.complete()})))})))}),(function(t){n.add(e.schedule((function(){return r.error(t)})))}))}))),n}))}(t,e);if(k(t))return R(t,e);if(function(t){return t&&"function"==typeof t[C]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new _((function(r){var n,o=new h;return o.add((function(){n&&"function"==typeof n.return&&n.return()})),o.add(e.schedule((function(){n=t[C](),o.add(e.schedule((function(){if(!r.closed){var t,e;try{var o=n.next();t=o.value,e=o.done}catch(t){return void r.error(t)}e?r.complete():(r.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function F(t,e){return e?L(t,e):t instanceof _?t:new _(M(t))}var D=function(t){function e(e){var r=t.call(this)||this;return r._value=e,r}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var r=t.prototype._subscribe.call(this,e);return r&&!r.closed&&e.next(this._value),r},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new x;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(T);function z(t){return t&&"function"==typeof t.schedule}function H(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new V(t,e))}}var V=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new U(t,this.project,this.thisArg))},t}(),U=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(b),Y=function(t){function e(e){var r=t.call(this)||this;return r.parent=e,r}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(b),W=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(b);function q(t,e){if(!e.closed)return t instanceof _?t.subscribe(e):M(t)(e)}function J(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(J((function(r,n){return F(t(r,n)).pipe(H((function(t,o){return e(r,t,n,o)})))}),r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new K(t,r))})}var K=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new G(t,this.project,this.concurrent))},t}(),G=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=r,o.concurrent=n,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new Y(this),r=this.destination;r.add(e);var n=q(t,e);n!==e&&r.add(n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(W);function $(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),J(g,t)}function Z(t,e){return e?R(t,e):new _(N(t))}function Q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=Number.POSITIVE_INFINITY,n=null,o=t[t.length-1];return z(o)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof o&&(r=t.pop()),null===n&&1===t.length&&t[0]instanceof _?t[0]:$(r)(Z(t,n))}function X(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return z(r)?(t.pop(),R(t,r)):Z(t)}var tt=new _((function(t){return t.complete()}));function et(t){return t?function(t){return new _((function(e){return t.schedule((function(){return e.complete()}))}))}(t):tt}function rt(t){return function(e){return e.lift(new nt(t))}}var nt=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var r=new ot(t),n=q(this.notifier,new Y(r));return n&&!r.seenValue?(r.add(n),e.subscribe(r)):r},t}(),ot=function(t){function e(e){var r=t.call(this,e)||this;return r.seenValue=!1,r}return o(e,t),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(W);function it(){return function(t){return t.lift(new st(t))}}var st=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var r=this.connectable;r._refCount++;var n=new ut(t,r),o=e.subscribe(n);return n.closed||(n.connection=r.connect()),o},t}(),ut=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var r=this.connection,n=t._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null},e}(b),ct=function(t){function e(e,r){var n=t.call(this)||this;return n.source=e,n.subjectFactory=r,n._refCount=0,n._isComplete=!1,n}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new h).add(this.source.subscribe(new lt(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t},e.prototype.refCount=function(){return it()(this)},e}(_),at=function(){var t=ct.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),lt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.connectable=r,n}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(S);var ft=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var r=this.selector,n=this.subjectFactory(),o=r(n).subscribe(t);return o.add(e.subscribe(n)),o},t}();function pt(){return new T}function ht(){return function(t){return it()((e=pt,function(t){var n;if(n="function"==typeof e?e:function(){return e},"function"==typeof r)return t.lift(new ft(n,r));var o=Object.create(t,at);return o.source=t,o.subjectFactory=n,o})(t));var e,r}}function dt(){}function yt(t,e,r){return function(n){return n.lift(new bt(t,e,r))}}var bt=function(){function t(t,e,r){this.nextOrObserver=t,this.error=e,this.complete=r}return t.prototype.call=function(t,e){return e.subscribe(new vt(t,this.nextOrObserver,this.error,this.complete))},t}(),vt=function(t){function e(e,r,n,o){var s=t.call(this,e)||this;return s._tapNext=dt,s._tapError=dt,s._tapComplete=dt,s._tapError=n||dt,s._tapComplete=o||dt,i(r)?(s._context=s,s._tapNext=r):r&&(s._context=r,s._tapNext=r.next||dt,s._tapError=r.error||dt,s._tapComplete=r.complete||dt),s}return o(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(b),mt=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}();function gt(t,e){return function(r){return r.lift(new wt(t,e))}}var wt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new _t(t,this.predicate,this.thisArg))},t}(),_t=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.predicate=r,o.thisArg=n,o.count=0,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(b),Ot=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}();function xt(t){return function(e){return 0===t?et():e.lift(new Et(t))}}var Et=function(){function t(t){if(this.total=t,this.total<0)throw new Ot}return t.prototype.call=function(t,e){return e.subscribe(new St(t,this.total))},t}(),St=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.ring=new Array,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.ring,r=this.total,n=this.count++;e.length<r?e.push(t):e[n%r]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var r=this.count>=this.total?this.total:this.count,n=this.ring,o=0;o<r;o++){var i=e++%r;t.next(n[i])}t.complete()},e}(b);function Tt(t){return void 0===t&&(t=It),function(e){return e.lift(new jt(t))}}var jt=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new Pt(t,this.errorFactory))},t}(),Pt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.errorFactory=r,n.hasValue=!1,n}return o(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(b);function It(){return new mt}function Nt(t){return void 0===t&&(t=null),function(e){return e.lift(new At(t))}}var At=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new Ct(t,this.defaultValue))},t}(),Ct=function(t){function e(e,r){var n=t.call(this,e)||this;return n.defaultValue=r,n.isEmpty=!0,n}return o(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(b);function kt(t,e){var r=arguments.length>=2;return function(n){return n.pipe(t?gt((function(e,r){return t(e,r,n)})):g,xt(1),r?Nt(e):Tt((function(){return new mt})))}}function Bt(t){return function(e){return 0===t?et():e.lift(new Rt(t))}}var Mt,Rt=function(){function t(t){if(this.total=t,this.total<0)throw new Ot}return t.prototype.call=function(t,e){return e.subscribe(new Lt(t,this.total))},t}(),Lt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.total=r,n.count=0,n}return o(e,t),e.prototype._next=function(t){var e=this.total,r=++this.count;r<=e&&(this.destination.next(t),r===e&&(this.destination.complete(),this.unsubscribe()))},e}(b),Ft=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n}return o(e,t),e.prototype.schedule=function(e,r){return void 0===r&&(r=0),r>0?t.prototype.schedule.call(this,e,r):(this.delay=r,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,r){return r>0||this.closed?t.prototype.execute.call(this,e,r):this._execute(e,r)},e.prototype.requestAsyncId=function(e,r,n){return void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0?t.prototype.requestAsyncId.call(this,e,r,n):e.flush(this)},e}(function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.scheduler=e,n.work=r,n.pending=!1,n}return o(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var r=this.id,n=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(n,r,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,r){return void 0===r&&(r=0),setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,e,r){if(void 0===r&&(r=0),null!==r&&this.delay===r&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var r=!1,n=void 0;try{this.work(t)}catch(t){r=!0,n=!!t&&t||new Error(t)}if(r)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,r=e.actions,n=r.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&r.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,r){return t.call(this)||this}return o(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(h))),Dt=function(){function t(e,r){void 0===r&&(r=t.now),this.SchedulerAction=e,this.now=r}return t.prototype.schedule=function(t,e,r){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(r,e)},t.now=function(){return Date.now()},t}(),zt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(function(t){function e(r,n){void 0===n&&(n=Dt.now);var o=t.call(this,r,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():n()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return o(e,t),e.prototype.schedule=function(r,n,o){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(r,n,o):t.prototype.schedule.call(this,r,n,o)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var r;this.active=!0;do{if(r=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,r){for(;t=e.shift();)t.unsubscribe();throw r}}},e}(Dt)))(Ft);Mt||(Mt={});var Ht=function(){function t(t,e,r){this.kind=t,this.value=e,this.error=r,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,r){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return r&&r()}},t.prototype.accept=function(t,e,r){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,r)},t.prototype.toObservable=function(){switch(this.kind){case"N":return X(this.value);case"E":return P(this.error);case"C":return et()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();var Vt=function(t){function e(e,r,n){void 0===n&&(n=0);var o=t.call(this,e)||this;return o.scheduler=r,o.delay=n,o}return o(e,t),e.dispatch=function(t){var e=t.notification,r=t.destination;e.observe(r),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new Ut(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(Ht.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(Ht.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(Ht.createComplete()),this.unsubscribe()},e}(b),Ut=function(){return function(t,e){this.notification=t,this.destination=e}}(),Yt=function(t){function e(e,r,n){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===r&&(r=Number.POSITIVE_INFINITY);var o=t.call(this)||this;return o.scheduler=n,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=e<1?1:e,o._windowTime=r<1?1:r,r===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return o(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var r=this._events;r.push(e),r.length>this._bufferSize&&r.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Wt(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,r=this._infiniteTimeWindow,n=r?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=n.length;if(this.closed)throw new x;if(this.isStopped||this.hasError?e=h.EMPTY:(this.observers.push(t),e=new E(this,t)),o&&t.add(t=new Vt(t,o)),r)for(var s=0;s<i&&!t.closed;s++)t.next(n[s]);else for(s=0;s<i&&!t.closed;s++)t.next(n[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||zt).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,r=this._windowTime,n=this._events,o=n.length,i=0;i<o&&!(t-n[i].time<r);)i++;return o>e&&(i=Math.max(i,o-e)),i>0&&n.splice(0,i),n},e}(T),Wt=function(){return function(t,e){this.time=t,this.value=e}}();function qt(t,e,r){var n;return n=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:r},function(t){return t.lift(function(t){var e,r,n=t.bufferSize,o=void 0===n?Number.POSITIVE_INFINITY:n,i=t.windowTime,s=void 0===i?Number.POSITIVE_INFINITY:i,u=t.refCount,c=t.scheduler,a=0,l=!1,f=!1;return function(t){var n;a++,!e||l?(l=!1,e=new Yt(o,s,c),n=e.subscribe(this),r=t.subscribe({next:function(t){e.next(t)},error:function(t){l=!0,e.error(t)},complete:function(){f=!0,r=void 0,e.complete()}})):n=e.subscribe(this),this.add((function(){a--,n.unsubscribe(),r&&!f&&u&&0===a&&(r.unsubscribe(),r=void 0,e=void 0)}))}}(n))}}function Jt(t,e){var r=!1;return arguments.length>=2&&(r=!0),function(n){return n.lift(new Kt(t,e,r))}}var Kt=function(){function t(t,e,r){void 0===r&&(r=!1),this.accumulator=t,this.seed=e,this.hasSeed=r}return t.prototype.call=function(t,e){return e.subscribe(new Gt(t,this.accumulator,this.seed,this.hasSeed))},t}(),Gt=function(t){function e(e,r,n,o){var i=t.call(this,e)||this;return i.accumulator=r,i._seed=n,i.hasSeed=o,i.index=0,i}return o(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.accumulator(this.seed,t,r)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(b);function $t(t){return function(e){return e.lift(new Zt(t))}}var Zt=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Qt(t,this.value))},t}(),Qt=function(t){function e(e,r){var n=t.call(this,e)||this;return n.value=r,n}return o(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(b),Xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,r,n,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(b),te=function(t){function e(e,r,n){var o=t.call(this)||this;return o.parent=e,o.outerValue=r,o.outerIndex=n,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(b);function ee(t,e,r,n,o){if(void 0===o&&(o=new te(t,r,n)),!o.closed)return e instanceof _?e.subscribe(o):M(e)(o)}function re(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var r;"function"==typeof t[t.length-1]&&(r=t.pop());var n=t;return e.lift(new ne(n,r))}}var ne=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new oe(t,this.observables,this.project))},t}(),oe=function(t){function e(e,r,n){var o=t.call(this,e)||this;o.observables=r,o.project=n,o.toRespond=[];var i=r.length;o.values=new Array(i);for(var s=0;s<i;s++)o.toRespond.push(s);for(s=0;s<i;s++){var u=r[s];o.add(ee(o,u,void 0,s))}return o}return o(e,t),e.prototype.notifyNext=function(t,e,r){this.values[r]=e;var n=this.toRespond;if(n.length>0){var o=n.indexOf(r);-1!==o&&n.splice(o,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(Xt);function ie(){return $(1)}function se(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ie()(X.apply(void 0,t))}function ue(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return se(e,X.apply(void 0,t))}}function ce(t){return function(e){var r=new ae(t),n=e.lift(r);return r.caught=n}}var ae=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new le(t,this.selector,this.caught))},t}(),le=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.selector=r,o.caught=n,o}return o(e,t),e.prototype.error=function(e){if(!this.isStopped){var r=void 0;try{r=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var n=new Y(this);this.add(n);var o=q(r,n);o!==n&&this.add(o)}},e}(W);var fe=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new pe(t,this.compare,this.keySelector))},t}(),pe=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.keySelector=n,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return o(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},e}(b);function he(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return z(r)?(t.pop(),function(e){return se(t,e,r)}):function(e){return se(t,e)}}var de=r(0);const ye=t=>new _(e=>{if("string"!=typeof t)return e.error("expect a string");const r=new Blob([t]),n=new FileReader;n.readAsArrayBuffer(r),n.onloadend=function(){const t=new Uint8Array(n.result);e.next(t),e.complete()}}),be=t=>new _(e=>{const r=new WebSocket(t,"ritp");r.binaryType="arraybuffer";const n=new T,o=new _(t=>{const e=e=>{t.error(e.reason)};return r.addEventListener("close",e),()=>{r.removeEventListener("close",e)}}),i=new _(t=>{n.pipe(rt(o)).subscribe(t=>r.send(t),e=>{r.close(4e3,e.toString()),t.error(e)},()=>{r.close(),t.complete()});const e=e=>{const r=new Uint8Array(e.data);t.next(r)};return r.addEventListener("message",e),()=>{r.removeEventListener("message",e),n.complete()}}).pipe(rt(o),ht());r.onclose=function(t){e.error(t.reason)},r.onopen=function(t){r.onclose=null,e.next({buffers:i,sender:n}),e.complete()}});class ve{constructor(){this.map=new Map,this.firstKey=0,this.currentKey=0,this.push=t=>this.map.set(this.currentKey++,t),this.pop=()=>{const t=this.map.get(this.firstKey);return this.map.delete(this.firstKey),this.firstKey++,t}}*[Symbol.iterator](){for(;this.firstKey<this.currentKey;)yield this.pop()}}const me=(t,e)=>{const r=new Map,n=t.pipe(yt(t=>{const n=r.get(e(t));n&&n.forEach(e=>e.next(t))}),kt(),ht());return t=>new _(e=>{let n=r.get(t);return n||(n=new Set,r.set(t,n)),n.add(e),()=>{n.delete(e),0==n.size&&r.delete(t)}}).pipe(rt(n))},ge=(t,e,r)=>new _(n=>{let o=Q(t.pipe($t(-1)),e).pipe(Jt(({windowSize:t,increment:e,decrement:o},i)=>{if(i>0?e+=i:o-=i,o>t)throw r;return o>=t/2&&(t=t-o+e,e>0&&n.next(e),e=0,o=0),{windowSize:t,increment:e,decrement:o}},{windowSize:0,increment:0,decrement:0})).subscribe(t=>{},n.error,n.complete);return()=>{o.unsubscribe()}}),we=(t,e,r,n)=>o=>{const i=t(),s=r(i).pipe(Bt(1),J(t=>P(t.close))),u=n(i).pipe(H(t=>t.pull),rt(s),ht()),c=new T,a=new D(0),l=c.pipe(rt(s)),f=Q(a,u).pipe(Jt((t,e)=>t+e,0),qt(1)),p=f.pipe(H(t=>t>0),(function(t){return t.lift(new fe(h,d))}),qt(1));var h,d;return l.pipe(re(p),gt(([t,e])=>e),H(([t,e])=>({streamId:i,buf:t})),yt(t=>a.next(-1)),he({streamId:i,header:o}),ue({streamId:i,end:{reason:de.ritp.End.Reason.COMPLETE}}),ce(t=>X({streamId:i,end:{reason:de.ritp.End.Reason.CANCEL,message:t.message}}))).subscribe(e),{pulls:u,sendableAmounts:f,bufSender:c,isSendable:p}},_e=t=>e=>e.pipe(J(({buffers:e,sender:r})=>{const{msgs:n,pullsToGetMsg:o,info:i,remoteClose:s,errInfoMoreThanOnce:u}=(t=>{const e=t.pipe(H(t=>de.ritp.Frame.decode(t)),ht()),r=me(e,t=>t.type),n=r("close").pipe(Bt(1),J(t=>P(t.close)),qt()),o=r("info").pipe(H(t=>t.info),qt()),i=o.pipe(Jt((t,e)=>t+1,0),gt(t=>t>1),Bt(1),J(t=>P({reason:de.ritp.Close.Reason.PROTOCOL_ERROR,message:"cannot send Info more than once"}))),s=r("pull").pipe(H(t=>t.pull));return{msgs:r("msg").pipe(H(t=>t.msg)),pullsToGetMsg:s,info:o,remoteClose:n,errInfoMoreThanOnce:i}})(e),{msgSender:c,msgPuller:a,pullFramesToSend:l,msgFramesToSend:f,newStreamId:p}=((t,e)=>{const r=new ve,n=e.pipe(J(t=>F(r).pipe(Bt(t))),ht()),o=new T,i=new D(0),s=Q(i,e,n.pipe($t(-1))).pipe(Jt((t,e)=>t+e,0),qt(1)),u=Q(n,o.pipe(re(s),J(([t,e])=>e>0?X(t):tt.pipe(yt({complete:()=>r.push(t)}))),yt(t=>i.next(-1)))).pipe(H(t=>({msg:t}))),c=new T,a=ge(t,c,{reason:de.ritp.Close.Reason.PROTOCOL_ERROR,message:"input msg overflow"}).pipe(H(t=>({pull:t})));let l=0;return{msgSender:o,msgPuller:c,pullFramesToSend:a,msgFramesToSend:u,newStreamId:()=>l++}})(n,o),{getCloseMsgsByStreamId:h,getPullMsgsByStreamId:d,getHeaderMsgsByFn:y,getEndMsgsByStreamId:b,getBufMsgsByStreamId:v}=(t=>{const e=me(t,t=>t.type),r=e("close"),n=me(r,t=>t.streamId),o=e("pull"),i=me(o,t=>t.streamId),s=e("end"),u=me(s,t=>t.streamId),c=e("buf"),a=me(c,t=>t.streamId),l=e("header");return{getHeaderMsgsByFn:me(l,t=>t.header.fn),getCloseMsgsByStreamId:n,getPullMsgsByStreamId:i,getEndMsgsByStreamId:u,getBufMsgsByStreamId:a}})(n),m=Q(u);return Q(f,l).pipe(he({info:t}),rt(m),ce(t=>X({close:t})),H(t=>de.ritp.Frame.encode(t).finish()),rt(s)).subscribe(r),i.pipe(H(t=>{const e=((t,e,r,n)=>o=>e(o).pipe(H(({streamId:e,header:o})=>{const i=r(e).pipe(Bt(1),J(t=>t.end.reason!=de.ritp.End.Reason.COMPLETE?P(t.end):X(t.end))),s=new T,u=n(e).pipe(H(t=>t.buf),rt(i),rt(s.pipe(kt())),ht());return ge(u,s,{reason:de.ritp.Close.Reason.PROTOCOL_ERROR,message:"input buf overflow"}).pipe(H(t=>({streamId:e,pull:t})),ue({streamId:e,close:{reason:de.ritp.Close.Reason.APPLICATION_ERROR,message:""}}),ce(t=>X({streamId:e,close:{reason:de.ritp.Close.Reason.APPLICATION_ERROR,message:t.message}}))).subscribe(t),{header:o,bufs:u,bufPuller:s}})))(c,y,b,v),r=we(p,c,h,d);return{remoteInfo:t,msgs:n,msgPuller:a,register:e,stream:r}}))}))}])}));