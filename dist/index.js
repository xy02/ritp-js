!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ritp_js=e():t.ritp_js=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=20)}([function(t,e,n){"use strict";var r,o=n(4),i=o.Reader,s=o.Writer,u=o.util,c=o.roots.default||(o.roots.default={});c.ritp=((r={}).PeerInfo=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.version="",t.prototype.metadata=u.newBuffer([]),t.prototype.chunk=u.newBuffer([]),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.version&&Object.hasOwnProperty.call(t,"version")&&e.uint32(10).string(t.version),null!=t.metadata&&Object.hasOwnProperty.call(t,"metadata")&&e.uint32(18).bytes(t.metadata),null!=t.chunk&&Object.hasOwnProperty.call(t,"chunk")&&e.uint32(26).bytes(t.chunk),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.PeerInfo;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.version=t.string();break;case 2:r.metadata=t.bytes();break;case 3:r.chunk=t.bytes();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.version&&t.hasOwnProperty("version")&&!u.isString(t.version)?"version: string expected":null!=t.metadata&&t.hasOwnProperty("metadata")&&!(t.metadata&&"number"==typeof t.metadata.length||u.isString(t.metadata))?"metadata: buffer expected":null!=t.chunk&&t.hasOwnProperty("chunk")&&!(t.chunk&&"number"==typeof t.chunk.length||u.isString(t.chunk))?"chunk: buffer expected":null},t.fromObject=function(t){if(t instanceof c.ritp.PeerInfo)return t;var e=new c.ritp.PeerInfo;return null!=t.version&&(e.version=String(t.version)),null!=t.metadata&&("string"==typeof t.metadata?u.base64.decode(t.metadata,e.metadata=u.newBuffer(u.base64.length(t.metadata)),0):t.metadata.length&&(e.metadata=t.metadata)),null!=t.chunk&&("string"==typeof t.chunk?u.base64.decode(t.chunk,e.chunk=u.newBuffer(u.base64.length(t.chunk)),0):t.chunk.length&&(e.chunk=t.chunk)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.version="",e.bytes===String?n.metadata="":(n.metadata=[],e.bytes!==Array&&(n.metadata=u.newBuffer(n.metadata))),e.bytes===String?n.chunk="":(n.chunk=[],e.bytes!==Array&&(n.chunk=u.newBuffer(n.chunk)))),null!=t.version&&t.hasOwnProperty("version")&&(n.version=t.version),null!=t.metadata&&t.hasOwnProperty("metadata")&&(n.metadata=e.bytes===String?u.base64.encode(t.metadata,0,t.metadata.length):e.bytes===Array?Array.prototype.slice.call(t.metadata):t.metadata),null!=t.chunk&&t.hasOwnProperty("chunk")&&(n.chunk=e.bytes===String?u.base64.encode(t.chunk,0,t.chunk.length):e.bytes===Array?Array.prototype.slice.call(t.chunk):t.chunk),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.Frame=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.pull=0,t.prototype.event=null,t.prototype.control=null,t.prototype.disconnect=null,Object.defineProperty(t.prototype,"type",{get:u.oneOfGetter(e=["pull","event","control","disconnect"]),set:u.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.pull&&Object.hasOwnProperty.call(t,"pull")&&e.uint32(8).uint32(t.pull),null!=t.event&&Object.hasOwnProperty.call(t,"event")&&c.ritp.Event.encode(t.event,e.uint32(18).fork()).ldelim(),null!=t.control&&Object.hasOwnProperty.call(t,"control")&&c.ritp.Control.encode(t.control,e.uint32(26).fork()).ldelim(),null!=t.disconnect&&Object.hasOwnProperty.call(t,"disconnect")&&c.ritp.Disconnect.encode(t.disconnect,e.uint32(34).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Frame;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.pull=t.uint32();break;case 2:r.event=c.ritp.Event.decode(t,t.uint32());break;case 3:r.control=c.ritp.Control.decode(t,t.uint32());break;case 4:r.disconnect=c.ritp.Disconnect.decode(t,t.uint32());break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.pull&&t.hasOwnProperty("pull")&&(e.type=1,!u.isInteger(t.pull)))return"pull: integer expected";if(null!=t.event&&t.hasOwnProperty("event")){if(1===e.type)return"type: multiple values";if(e.type=1,n=c.ritp.Event.verify(t.event))return"event."+n}if(null!=t.control&&t.hasOwnProperty("control")){if(1===e.type)return"type: multiple values";if(e.type=1,n=c.ritp.Control.verify(t.control))return"control."+n}if(null!=t.disconnect&&t.hasOwnProperty("disconnect")){if(1===e.type)return"type: multiple values";var n;if(e.type=1,n=c.ritp.Disconnect.verify(t.disconnect))return"disconnect."+n}return null},t.fromObject=function(t){if(t instanceof c.ritp.Frame)return t;var e=new c.ritp.Frame;if(null!=t.pull&&(e.pull=t.pull>>>0),null!=t.event){if("object"!=typeof t.event)throw TypeError(".ritp.Frame.event: object expected");e.event=c.ritp.Event.fromObject(t.event)}if(null!=t.control){if("object"!=typeof t.control)throw TypeError(".ritp.Frame.control: object expected");e.control=c.ritp.Control.fromObject(t.control)}if(null!=t.disconnect){if("object"!=typeof t.disconnect)throw TypeError(".ritp.Frame.disconnect: object expected");e.disconnect=c.ritp.Disconnect.fromObject(t.disconnect)}return e},t.toObject=function(t,e){e||(e={});var n={};return null!=t.pull&&t.hasOwnProperty("pull")&&(n.pull=t.pull,e.oneofs&&(n.type="pull")),null!=t.event&&t.hasOwnProperty("event")&&(n.event=c.ritp.Event.toObject(t.event,e),e.oneofs&&(n.type="event")),null!=t.control&&t.hasOwnProperty("control")&&(n.control=c.ritp.Control.toObject(t.control,e),e.oneofs&&(n.type="control")),null!=t.disconnect&&t.hasOwnProperty("disconnect")&&(n.disconnect=c.ritp.Disconnect.toObject(t.disconnect,e),e.oneofs&&(n.type="disconnect")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.Disconnect=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Disconnect;t.pos<n;){var o=t.uint32();t.skipType(7&o)}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null},t.fromObject=function(t){return t instanceof c.ritp.Disconnect?t:new c.ritp.Disconnect},t.toObject=function(){return{}},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.Event=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.streamId=u.Long?u.Long.fromBits(0,0,!0):0,t.prototype.request=null,t.prototype.chunk=u.newBuffer([]),t.prototype.end=null,Object.defineProperty(t.prototype,"type",{get:u.oneOfGetter(e=["request","chunk","end"]),set:u.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.streamId&&Object.hasOwnProperty.call(t,"streamId")&&e.uint32(8).uint64(t.streamId),null!=t.request&&Object.hasOwnProperty.call(t,"request")&&c.ritp.Request.encode(t.request,e.uint32(18).fork()).ldelim(),null!=t.chunk&&Object.hasOwnProperty.call(t,"chunk")&&e.uint32(26).bytes(t.chunk),null!=t.end&&Object.hasOwnProperty.call(t,"end")&&c.ritp.End.encode(t.end,e.uint32(34).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Event;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.streamId=t.uint64();break;case 2:r.request=c.ritp.Request.decode(t,t.uint32());break;case 3:r.chunk=t.bytes();break;case 4:r.end=c.ritp.End.decode(t,t.uint32());break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.streamId&&t.hasOwnProperty("streamId")&&!(u.isInteger(t.streamId)||t.streamId&&u.isInteger(t.streamId.low)&&u.isInteger(t.streamId.high)))return"streamId: integer|Long expected";if(null!=t.request&&t.hasOwnProperty("request")&&(e.type=1,n=c.ritp.Request.verify(t.request)))return"request."+n;if(null!=t.chunk&&t.hasOwnProperty("chunk")){if(1===e.type)return"type: multiple values";if(e.type=1,!(t.chunk&&"number"==typeof t.chunk.length||u.isString(t.chunk)))return"chunk: buffer expected"}if(null!=t.end&&t.hasOwnProperty("end")){if(1===e.type)return"type: multiple values";var n;if(e.type=1,n=c.ritp.End.verify(t.end))return"end."+n}return null},t.fromObject=function(t){if(t instanceof c.ritp.Event)return t;var e=new c.ritp.Event;if(null!=t.streamId&&(u.Long?(e.streamId=u.Long.fromValue(t.streamId)).unsigned=!0:"string"==typeof t.streamId?e.streamId=parseInt(t.streamId,10):"number"==typeof t.streamId?e.streamId=t.streamId:"object"==typeof t.streamId&&(e.streamId=new u.LongBits(t.streamId.low>>>0,t.streamId.high>>>0).toNumber(!0))),null!=t.request){if("object"!=typeof t.request)throw TypeError(".ritp.Event.request: object expected");e.request=c.ritp.Request.fromObject(t.request)}if(null!=t.chunk&&("string"==typeof t.chunk?u.base64.decode(t.chunk,e.chunk=u.newBuffer(u.base64.length(t.chunk)),0):t.chunk.length&&(e.chunk=t.chunk)),null!=t.end){if("object"!=typeof t.end)throw TypeError(".ritp.Event.end: object expected");e.end=c.ritp.End.fromObject(t.end)}return e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(u.Long){var r=new u.Long(0,0,!0);n.streamId=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.streamId=e.longs===String?"0":0;return null!=t.streamId&&t.hasOwnProperty("streamId")&&("number"==typeof t.streamId?n.streamId=e.longs===String?String(t.streamId):t.streamId:n.streamId=e.longs===String?u.Long.prototype.toString.call(t.streamId):e.longs===Number?new u.LongBits(t.streamId.low>>>0,t.streamId.high>>>0).toNumber(!0):t.streamId),null!=t.request&&t.hasOwnProperty("request")&&(n.request=c.ritp.Request.toObject(t.request,e),e.oneofs&&(n.type="request")),null!=t.chunk&&t.hasOwnProperty("chunk")&&(n.chunk=e.bytes===String?u.base64.encode(t.chunk,0,t.chunk.length):e.bytes===Array?Array.prototype.slice.call(t.chunk):t.chunk,e.oneofs&&(n.type="chunk")),null!=t.end&&t.hasOwnProperty("end")&&(n.end=c.ritp.End.toObject(t.end,e),e.oneofs&&(n.type="end")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.Request=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.handlerName="",t.prototype.data=u.newBuffer([]),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.handlerName&&Object.hasOwnProperty.call(t,"handlerName")&&e.uint32(10).string(t.handlerName),null!=t.data&&Object.hasOwnProperty.call(t,"data")&&e.uint32(18).bytes(t.data),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Request;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.handlerName=t.string();break;case 2:r.data=t.bytes();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){return"object"!=typeof t||null===t?"object expected":null!=t.handlerName&&t.hasOwnProperty("handlerName")&&!u.isString(t.handlerName)?"handlerName: string expected":null!=t.data&&t.hasOwnProperty("data")&&!(t.data&&"number"==typeof t.data.length||u.isString(t.data))?"data: buffer expected":null},t.fromObject=function(t){if(t instanceof c.ritp.Request)return t;var e=new c.ritp.Request;return null!=t.handlerName&&(e.handlerName=String(t.handlerName)),null!=t.data&&("string"==typeof t.data?u.base64.decode(t.data,e.data=u.newBuffer(u.base64.length(t.data)),0):t.data.length&&(e.data=t.data)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.handlerName="",e.bytes===String?n.data="":(n.data=[],e.bytes!==Array&&(n.data=u.newBuffer(n.data)))),null!=t.handlerName&&t.hasOwnProperty("handlerName")&&(n.handlerName=t.handlerName),null!=t.data&&t.hasOwnProperty("data")&&(n.data=e.bytes===String?u.base64.encode(t.data,0,t.data.length):e.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.End=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e,n;return t.prototype.reason=0,t.prototype.detail="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.reason&&Object.hasOwnProperty.call(t,"reason")&&e.uint32(8).int32(t.reason),null!=t.detail&&Object.hasOwnProperty.call(t,"detail")&&e.uint32(18).string(t.detail),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.End;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.reason=t.int32();break;case 2:r.detail=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.reason&&t.hasOwnProperty("reason"))switch(t.reason){default:return"reason: enum value expected";case 0:case 1:}return null!=t.detail&&t.hasOwnProperty("detail")&&!u.isString(t.detail)?"detail: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.End)return t;var e=new c.ritp.End;switch(t.reason){case"FINISH":case 0:e.reason=0;break;case"CANCEL":case 1:e.reason=1}return null!=t.detail&&(e.detail=String(t.detail)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.reason=e.enums===String?"FINISH":0,n.detail=""),null!=t.reason&&t.hasOwnProperty("reason")&&(n.reason=e.enums===String?c.ritp.End.Reason[t.reason]:t.reason),null!=t.detail&&t.hasOwnProperty("detail")&&(n.detail=t.detail),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t.Reason=(e={},(n=Object.create(e))[e[0]="FINISH"]=0,n[e[1]="CANCEL"]=1,n),t}(),r.Control=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e;return t.prototype.streamId=u.Long?u.Long.fromBits(0,0,!0):0,t.prototype.pull=0,t.prototype.close=null,Object.defineProperty(t.prototype,"type",{get:u.oneOfGetter(e=["pull","close"]),set:u.oneOfSetter(e)}),t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.streamId&&Object.hasOwnProperty.call(t,"streamId")&&e.uint32(8).uint64(t.streamId),null!=t.pull&&Object.hasOwnProperty.call(t,"pull")&&e.uint32(16).uint32(t.pull),null!=t.close&&Object.hasOwnProperty.call(t,"close")&&c.ritp.Close.encode(t.close,e.uint32(26).fork()).ldelim(),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Control;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.streamId=t.uint64();break;case 2:r.pull=t.uint32();break;case 3:r.close=c.ritp.Close.decode(t,t.uint32());break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";var e={};if(null!=t.streamId&&t.hasOwnProperty("streamId")&&!(u.isInteger(t.streamId)||t.streamId&&u.isInteger(t.streamId.low)&&u.isInteger(t.streamId.high)))return"streamId: integer|Long expected";if(null!=t.pull&&t.hasOwnProperty("pull")&&(e.type=1,!u.isInteger(t.pull)))return"pull: integer expected";if(null!=t.close&&t.hasOwnProperty("close")){if(1===e.type)return"type: multiple values";e.type=1;var n=c.ritp.Close.verify(t.close);if(n)return"close."+n}return null},t.fromObject=function(t){if(t instanceof c.ritp.Control)return t;var e=new c.ritp.Control;if(null!=t.streamId&&(u.Long?(e.streamId=u.Long.fromValue(t.streamId)).unsigned=!0:"string"==typeof t.streamId?e.streamId=parseInt(t.streamId,10):"number"==typeof t.streamId?e.streamId=t.streamId:"object"==typeof t.streamId&&(e.streamId=new u.LongBits(t.streamId.low>>>0,t.streamId.high>>>0).toNumber(!0))),null!=t.pull&&(e.pull=t.pull>>>0),null!=t.close){if("object"!=typeof t.close)throw TypeError(".ritp.Control.close: object expected");e.close=c.ritp.Close.fromObject(t.close)}return e},t.toObject=function(t,e){e||(e={});var n={};if(e.defaults)if(u.Long){var r=new u.Long(0,0,!0);n.streamId=e.longs===String?r.toString():e.longs===Number?r.toNumber():r}else n.streamId=e.longs===String?"0":0;return null!=t.streamId&&t.hasOwnProperty("streamId")&&("number"==typeof t.streamId?n.streamId=e.longs===String?String(t.streamId):t.streamId:n.streamId=e.longs===String?u.Long.prototype.toString.call(t.streamId):e.longs===Number?new u.LongBits(t.streamId.low>>>0,t.streamId.high>>>0).toNumber(!0):t.streamId),null!=t.pull&&t.hasOwnProperty("pull")&&(n.pull=t.pull,e.oneofs&&(n.type="pull")),null!=t.close&&t.hasOwnProperty("close")&&(n.close=c.ritp.Close.toObject(t.close,e),e.oneofs&&(n.type="close")),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t}(),r.Close=function(){function t(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}var e,n;return t.prototype.reason=0,t.prototype.detail="",t.create=function(e){return new t(e)},t.encode=function(t,e){return e||(e=s.create()),null!=t.reason&&Object.hasOwnProperty.call(t,"reason")&&e.uint32(8).int32(t.reason),null!=t.detail&&Object.hasOwnProperty.call(t,"detail")&&e.uint32(18).string(t.detail),e},t.encodeDelimited=function(t,e){return this.encode(t,e).ldelim()},t.decode=function(t,e){t instanceof i||(t=i.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new c.ritp.Close;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:r.reason=t.int32();break;case 2:r.detail=t.string();break;default:t.skipType(7&o)}}return r},t.decodeDelimited=function(t){return t instanceof i||(t=new i(t)),this.decode(t,t.uint32())},t.verify=function(t){if("object"!=typeof t||null===t)return"object expected";if(null!=t.reason&&t.hasOwnProperty("reason"))switch(t.reason){default:return"reason: enum value expected";case 0:case 1:case 2:}return null!=t.detail&&t.hasOwnProperty("detail")&&!u.isString(t.detail)?"detail: string expected":null},t.fromObject=function(t){if(t instanceof c.ritp.Close)return t;var e=new c.ritp.Close;switch(t.reason){case"ABORT":case 0:e.reason=0;break;case"APPLICATION_ERROR":case 1:e.reason=1;break;case"PROTOCOL_ERROR":case 2:e.reason=2}return null!=t.detail&&(e.detail=String(t.detail)),e},t.toObject=function(t,e){e||(e={});var n={};return e.defaults&&(n.reason=e.enums===String?"ABORT":0,n.detail=""),null!=t.reason&&t.hasOwnProperty("reason")&&(n.reason=e.enums===String?c.ritp.Close.Reason[t.reason]:t.reason),null!=t.detail&&t.hasOwnProperty("detail")&&(n.detail=t.detail),n},t.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},t.Reason=(e={},(n=Object.create(e))[e[0]="ABORT"]=0,n[e[1]="APPLICATION_ERROR"]=1,n[e[2]="PROTOCOL_ERROR"]=2,n),t}(),r),t.exports=c},function(t,e,n){"use strict";(function(t){var r=e;function o(t,e,n){for(var r=Object.keys(e),o=0;o<r.length;++o)void 0!==t[r[o]]&&n||(t[r[o]]=e[r[o]]);return t}function i(t){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&o(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}r.asPromise=n(7),r.base64=n(8),r.EventEmitter=n(9),r.float=n(10),r.inquire=n(11),r.utf8=n(12),r.pool=n(13),r.LongBits=n(14),r.isNode=Boolean(void 0!==t&&t&&t.process&&t.process.versions&&t.process.versions.node),r.global=r.isNode&&t||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},r.isString=function(t){return"string"==typeof t||t instanceof String},r.isObject=function(t){return t&&"object"==typeof t},r.isset=r.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var t=r.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(t){return"number"==typeof t?r.Buffer?r._Buffer_allocUnsafe(t):new r.Array(t):r.Buffer?r._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(t){return t?r.LongBits.from(t).toHash():r.LongBits.zeroHash},r.longFromHash=function(t,e){var n=r.LongBits.fromHash(t);return r.Long?r.Long.fromBits(n.lo,n.hi,e):n.toNumber(Boolean(e))},r.merge=o,r.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;n>-1;--n)if(1===e[t[n]]&&void 0!==this[t[n]]&&null!==this[t[n]])return t[n]}},r.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var t=r.Buffer;t?(r._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,n){return new t(e,n)},r._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(6))},function(t,e,n){"use strict";t.exports=f;var r,o=n(1),i=o.LongBits,s=o.base64,u=o.utf8;function c(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function a(){}function l(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function f(){this.len=0,this.head=new c(a,0,0),this.tail=this.head,this.states=null}var h=function(){return o.Buffer?function(){return(f.create=function(){return new r})()}:function(){return new f}};function p(t,e,n){e[n]=255&t}function d(t,e){this.len=t,this.next=void 0,this.val=e}function y(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function b(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}f.create=h(),f.alloc=function(t){return new o.Array(t)},o.Array!==Array&&(f.alloc=o.pool(f.alloc,o.Array.prototype.subarray)),f.prototype._push=function(t,e,n){return this.tail=this.tail.next=new c(t,e,n),this.len+=e,this},d.prototype=Object.create(c.prototype),d.prototype.fn=function(t,e,n){for(;t>127;)e[n++]=127&t|128,t>>>=7;e[n]=t},f.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new d((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},f.prototype.int32=function(t){return t<0?this._push(y,10,i.fromNumber(t)):this.uint32(t)},f.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},f.prototype.uint64=function(t){var e=i.from(t);return this._push(y,e.length(),e)},f.prototype.int64=f.prototype.uint64,f.prototype.sint64=function(t){var e=i.from(t).zzEncode();return this._push(y,e.length(),e)},f.prototype.bool=function(t){return this._push(p,1,t?1:0)},f.prototype.fixed32=function(t){return this._push(b,4,t>>>0)},f.prototype.sfixed32=f.prototype.fixed32,f.prototype.fixed64=function(t){var e=i.from(t);return this._push(b,4,e.lo)._push(b,4,e.hi)},f.prototype.sfixed64=f.prototype.fixed64,f.prototype.float=function(t){return this._push(o.float.writeFloatLE,4,t)},f.prototype.double=function(t){return this._push(o.float.writeDoubleLE,8,t)};var v=o.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var r=0;r<t.length;++r)e[n+r]=t[r]};f.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(p,1,0);if(o.isString(t)){var n=f.alloc(e=s.length(t));s.decode(t,n,0),t=n}return this.uint32(e)._push(v,e,t)},f.prototype.string=function(t){var e=u.length(t);return e?this.uint32(e)._push(u.write,e,t):this._push(p,1,0)},f.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new c(a,0,0),this.len=0,this},f.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(a,0,0),this.len=0),this},f.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},f.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},f._configure=function(t){r=t,f.create=h(),r._configure()}},function(t,e,n){"use strict";t.exports=c;var r,o=n(1),i=o.LongBits,s=o.utf8;function u(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function c(t){this.buf=t,this.pos=0,this.len=t.length}var a,l="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new c(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new c(t);throw Error("illegal buffer")},f=function(){return o.Buffer?function(t){return(c.create=function(t){return o.Buffer.isBuffer(t)?new r(t):l(t)})(t)}:l};function h(){var t=new i(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw u(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw u(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function p(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw u(this,8);return new i(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}c.create=f(),c.prototype._slice=o.Array.prototype.subarray||o.Array.prototype.slice,c.prototype.uint32=(a=4294967295,function(){if(a=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return a;if(a=(a|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return a;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return a}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return p(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return 0|p(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var t=o.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},c.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var t=o.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},c.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw u(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)},c.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},c.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw u(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw u(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},c._configure=function(t){r=t,c.create=f(),r._configure();var e=o.Long?"toLong":"toNumber";o.merge(c.prototype,{int64:function(){return h.call(this)[e](!1)},uint64:function(){return h.call(this)[e](!0)},sint64:function(){return h.call(this).zzDecode()[e](!1)},fixed64:function(){return d.call(this)[e](!0)},sfixed64:function(){return d.call(this)[e](!1)}})}},function(t,e,n){"use strict";t.exports=n(5)},function(t,e,n){"use strict";var r=e;function o(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(2),r.BufferWriter=n(15),r.Reader=n(3),r.BufferReader=n(16),r.util=n(1),r.rpc=n(17),r.roots=n(19),r.configure=o,o()},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";t.exports=function(t,e){var n=new Array(arguments.length-1),r=0,o=2,i=!0;for(;o<arguments.length;)n[r++]=arguments[o++];return new Promise((function(o,s){n[r]=function(t){if(i)if(i=!1,t)s(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];o.apply(null,e)}};try{t.apply(e||null,n)}catch(t){i&&(i=!1,s(t))}}))}},function(t,e,n){"use strict";var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var o=new Array(64),i=new Array(123),s=0;s<64;)i[o[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;r.encode=function(t,e,n){for(var r,i=null,s=[],u=0,c=0;e<n;){var a=t[e++];switch(c){case 0:s[u++]=o[a>>2],r=(3&a)<<4,c=1;break;case 1:s[u++]=o[r|a>>4],r=(15&a)<<2,c=2;break;case 2:s[u++]=o[r|a>>6],s[u++]=o[63&a],c=0}u>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),u=0)}return c&&(s[u++]=o[r],s[u++]=61,1===c&&(s[u++]=61)),i?(u&&i.push(String.fromCharCode.apply(String,s.slice(0,u))),i.join("")):String.fromCharCode.apply(String,s.slice(0,u))};r.decode=function(t,e,n){for(var r,o=n,s=0,u=0;u<t.length;){var c=t.charCodeAt(u++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:r=c,s=1;break;case 1:e[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:e[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:e[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return n-o},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},function(t,e,n){"use strict";function r(){this._listeners={}}t.exports=r,r.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this},r.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var n=this._listeners[t],r=0;r<n.length;)n[r].fn===e?n.splice(r,1):++r;return this},r.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<e.length;)e[r].fn.apply(e[r++].ctx,n)}return this}},function(t,e,n){"use strict";function r(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),r=128===n[3];function o(t,r,o){e[0]=t,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3]}function i(t,r,o){e[0]=t,r[o]=n[3],r[o+1]=n[2],r[o+2]=n[1],r[o+3]=n[0]}function s(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],e[0]}function u(t,r){return n[3]=t[r],n[2]=t[r+1],n[1]=t[r+2],n[0]=t[r+3],e[0]}t.writeFloatLE=r?o:i,t.writeFloatBE=r?i:o,t.readFloatLE=r?s:u,t.readFloatBE=r?u:s}():function(){function e(t,e,n,r){var o=e<0?1:0;if(o&&(e=-e),0===e)t(1/e>0?0:2147483648,n,r);else if(isNaN(e))t(2143289344,n,r);else if(e>34028234663852886e22)t((o<<31|2139095040)>>>0,n,r);else if(e<11754943508222875e-54)t((o<<31|Math.round(e/1401298464324817e-60))>>>0,n,r);else{var i=Math.floor(Math.log(e)/Math.LN2);t((o<<31|i+127<<23|8388607&Math.round(e*Math.pow(2,-i)*8388608))>>>0,n,r)}}function n(t,e,n){var r=t(e,n),o=2*(r>>31)+1,i=r>>>23&255,s=8388607&r;return 255===i?s?NaN:o*(1/0):0===i?1401298464324817e-60*o*s:o*Math.pow(2,i-150)*(s+8388608)}t.writeFloatLE=e.bind(null,o),t.writeFloatBE=e.bind(null,i),t.readFloatLE=n.bind(null,s),t.readFloatBE=n.bind(null,u)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),r=128===n[7];function o(t,r,o){e[0]=t,r[o]=n[0],r[o+1]=n[1],r[o+2]=n[2],r[o+3]=n[3],r[o+4]=n[4],r[o+5]=n[5],r[o+6]=n[6],r[o+7]=n[7]}function i(t,r,o){e[0]=t,r[o]=n[7],r[o+1]=n[6],r[o+2]=n[5],r[o+3]=n[4],r[o+4]=n[3],r[o+5]=n[2],r[o+6]=n[1],r[o+7]=n[0]}function s(t,r){return n[0]=t[r],n[1]=t[r+1],n[2]=t[r+2],n[3]=t[r+3],n[4]=t[r+4],n[5]=t[r+5],n[6]=t[r+6],n[7]=t[r+7],e[0]}function u(t,r){return n[7]=t[r],n[6]=t[r+1],n[5]=t[r+2],n[4]=t[r+3],n[3]=t[r+4],n[2]=t[r+5],n[1]=t[r+6],n[0]=t[r+7],e[0]}t.writeDoubleLE=r?o:i,t.writeDoubleBE=r?i:o,t.readDoubleLE=r?s:u,t.readDoubleBE=r?u:s}():function(){function e(t,e,n,r,o,i){var s=r<0?1:0;if(s&&(r=-r),0===r)t(0,o,i+e),t(1/r>0?0:2147483648,o,i+n);else if(isNaN(r))t(0,o,i+e),t(2146959360,o,i+n);else if(r>17976931348623157e292)t(0,o,i+e),t((s<<31|2146435072)>>>0,o,i+n);else{var u;if(r<22250738585072014e-324)t((u=r/5e-324)>>>0,o,i+e),t((s<<31|u/4294967296)>>>0,o,i+n);else{var c=Math.floor(Math.log(r)/Math.LN2);1024===c&&(c=1023),t(4503599627370496*(u=r*Math.pow(2,-c))>>>0,o,i+e),t((s<<31|c+1023<<20|1048576*u&1048575)>>>0,o,i+n)}}}function n(t,e,n,r,o){var i=t(r,o+e),s=t(r,o+n),u=2*(s>>31)+1,c=s>>>20&2047,a=4294967296*(1048575&s)+i;return 2047===c?a?NaN:u*(1/0):0===c?5e-324*u*a:u*Math.pow(2,c-1075)*(a+4503599627370496)}t.writeDoubleLE=e.bind(null,o,0,4),t.writeDoubleBE=e.bind(null,i,4,0),t.readDoubleLE=n.bind(null,s,0,4),t.readDoubleBE=n.bind(null,u,4,0)}(),t}function o(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function i(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function s(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function u(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=r(r)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},function(t,e,n){"use strict";var r=e;r.length=function(t){for(var e=0,n=0,r=0;r<t.length;++r)(n=t.charCodeAt(r))<128?e+=1:n<2048?e+=2:55296==(64512&n)&&56320==(64512&t.charCodeAt(r+1))?(++r,e+=4):e+=3;return e},r.read=function(t,e,n){if(n-e<1)return"";for(var r,o=null,i=[],s=0;e<n;)(r=t[e++])<128?i[s++]=r:r>191&&r<224?i[s++]=(31&r)<<6|63&t[e++]:r>239&&r<365?(r=((7&r)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,i[s++]=55296+(r>>10),i[s++]=56320+(1023&r)):i[s++]=(15&r)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,i)),s=0);return o?(s&&o.push(String.fromCharCode.apply(String,i.slice(0,s))),o.join("")):String.fromCharCode.apply(String,i.slice(0,s))},r.write=function(t,e,n){for(var r,o,i=n,s=0;s<t.length;++s)(r=t.charCodeAt(s))<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(o=t.charCodeAt(s+1)))?(r=65536+((1023&r)<<10)+(1023&o),++s,e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128);return n-i}},function(t,e,n){"use strict";t.exports=function(t,e,n){var r=n||8192,o=r>>>1,i=null,s=r;return function(n){if(n<1||n>o)return t(n);s+n>r&&(i=t(r),s=0);var u=e.call(i,s,s+=n);return 7&s&&(s=1+(7|s)),u}}},function(t,e,n){"use strict";t.exports=o;var r=n(1);function o(t,e){this.lo=t>>>0,this.hi=e>>>0}var i=o.zero=new o(0,0);i.toNumber=function(){return 0},i.zzEncode=i.zzDecode=function(){return this},i.length=function(){return 1};var s=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(t){if(0===t)return i;var e=t<0;e&&(t=-t);var n=t>>>0,r=(t-n)/4294967296>>>0;return e&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new o(n,r)},o.from=function(t){if("number"==typeof t)return o.fromNumber(t);if(r.isString(t)){if(!r.Long)return o.fromNumber(parseInt(t,10));t=r.Long.fromString(t)}return t.low||t.high?new o(t.low>>>0,t.high>>>0):i},o.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+4294967296*n)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(t){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var u=String.prototype.charCodeAt;o.fromHash=function(t){return t===s?i:new o((u.call(t,0)|u.call(t,1)<<8|u.call(t,2)<<16|u.call(t,3)<<24)>>>0,(u.call(t,4)|u.call(t,5)<<8|u.call(t,6)<<16|u.call(t,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},o.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},o.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},function(t,e,n){"use strict";t.exports=i;var r=n(2);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(1);function i(){r.call(this)}function s(t,e,n){t.length<40?o.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}i._configure=function(){i.alloc=o._Buffer_allocUnsafe,i.writeBytesBuffer=o.Buffer&&o.Buffer.prototype instanceof Uint8Array&&"set"===o.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var r=0;r<t.length;)e[n++]=t[r++]}},i.prototype.bytes=function(t){o.isString(t)&&(t=o._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(i.writeBytesBuffer,e,t),this},i.prototype.string=function(t){var e=o.Buffer.byteLength(t);return this.uint32(e),e&&this._push(s,e,t),this},i._configure()},function(t,e,n){"use strict";t.exports=i;var r=n(3);(i.prototype=Object.create(r.prototype)).constructor=i;var o=n(1);function i(t){r.call(this,t)}i._configure=function(){o.Buffer&&(i.prototype._slice=o.Buffer.prototype.slice)},i.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},i._configure()},function(t,e,n){"use strict";e.Service=n(18)},function(t,e,n){"use strict";t.exports=o;var r=n(1);function o(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}(o.prototype=Object.create(r.EventEmitter.prototype)).constructor=o,o.prototype.rpcCall=function t(e,n,o,i,s){if(!i)throw TypeError("request must be specified");var u=this;if(!s)return r.asPromise(t,u,e,n,o,i);if(u.rpcImpl)try{return u.rpcImpl(e,n[u.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function(t,n){if(t)return u.emit("error",t,e),s(t);if(null!==n){if(!(n instanceof o))try{n=o[u.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return u.emit("error",t,e),s(t)}return u.emit("data",n,e),s(null,n)}u.end(!0)}))}catch(t){return u.emit("error",t,e),void setTimeout((function(){s(t)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},o.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";n.r(e),n.d(e,"createH5WebSocket",(function(){return we})),n.d(e,"init",(function(){return ge}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t){return"function"==typeof t}var s=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function c(t){setTimeout((function(){throw t}),0)}var a={closed:!0,next:function(t){},error:function(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete:function(){}},l=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function f(t){return null!==t&&"object"==typeof t}var h=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),p=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this._parentOrParents,r=this._ctorUnsubscribe,o=this._unsubscribe,s=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var u=0;u<n.length;++u){n[u].remove(this)}if(i(o)){r&&(this._unsubscribe=void 0);try{o.call(this)}catch(t){e=t instanceof h?d(t.errors):[t]}}if(l(s)){u=-1;for(var c=s.length;++u<c;){var a=s[u];if(f(a))try{a.unsubscribe()}catch(t){e=e||[],t instanceof h?e=e.concat(d(t.errors)):e.push(t)}}}if(e)throw new h(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof t){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function d(t){return t.reduce((function(t,e){return t.concat(e instanceof h?e.errors:e)}),[])}var y=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),b=function(t){function e(n,r,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=a;break;case 1:if(!n){i.destination=a;break}if("object"==typeof n){n instanceof e?(i.syncErrorThrowable=n.syncErrorThrowable,i.destination=n,n.add(i)):(i.syncErrorThrowable=!0,i.destination=new v(i,n));break}default:i.syncErrorThrowable=!0,i.destination=new v(i,n,r,o)}return i}return o(e,t),e.prototype[y]=function(){return this},e.create=function(t,n,r){var o=new e(t,n,r);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(p),v=function(t){function e(e,n,r,o){var s,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return i(n)?s=n:n&&(s=n.next,r=n.error,o=n.complete,n!==a&&(i((c=Object.create(n)).unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=r,u._complete=o,u}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;c(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw t;c(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(c(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(b);var m=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function w(t){return t}function g(t){return 0===t.length?w:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var _=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,o=function(t,e,n){if(t){if(t instanceof b)return t;if(t[y])return t[y]()}return t||e||n?new b(t,e,n):new b(a)}(t,e,n);if(r?o.add(r.call(o,this.source)):o.add(this.source||u.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),u.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,o=e.isStopped;if(n||o)return!1;t=r&&r instanceof b?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=O(e))((function(e,r){var o;o=n.subscribe((function(e){try{t(e)}catch(t){r(t),o&&o.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[m]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:g(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=O(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function O(t){if(t||(t=u.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function x(t,e){return new _(e?function(n){return e.schedule(S,0,{error:t,subscriber:n})}:function(e){return e.error(t)})}function S(t){var e=t.error;t.subscriber.error(e)}function E(t){return t&&"function"==typeof t.schedule}var I=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};function j(t,e){return new _((function(n){var r=new p,o=0;return r.add(e.schedule((function(){o!==t.length?(n.next(t[o++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function k(t,e){return e?j(t,e):new _(I(t))}function N(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return E(n)?(t.pop(),j(t,n)):k(t)}var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t,e,n,r,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(b),C=function(t){function e(e,n,r){var o=t.call(this)||this;return o.parent=e,o.outerValue=n,o.outerIndex=r,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(b);function A(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var T=A(),B=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function L(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var R=function(t){if(t&&"function"==typeof t[m])return r=t,function(t){var e=r[m]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(B(t))return I(t);if(L(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,c),t};if(t&&"function"==typeof t[T])return e=t,function(t){for(var n=e[T]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,o=f(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function D(t,e,n,r,o){if(void 0===o&&(o=new C(t,n,r)),!o.closed)return e instanceof _?e.subscribe(o):R(e)(o)}var F={};function q(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0,r=void 0;return E(t[t.length-1])&&(r=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&l(t[0])&&(t=t[0]),k(t,r).lift(new M(n))}var M=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new V(t,this.resultSelector))},t}(),V=function(t){function e(e,n){var r=t.call(this,e)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return o(e,t),e.prototype._next=function(t){this.values.push(F),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(D(this,r,void 0,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n){var r=this.values,o=r[n],i=this.toRespond?o===F?--this.toRespond:this.toRespond:0;r[n]=e,0===i&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(P),z=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),H=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return o(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(p),U=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return o(e,t),e}(b),J=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o(e,t),e.prototype[y]=function(){return new U(this)},e.prototype.lift=function(t){var e=new Y(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new z;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new z;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),o=0;o<n;o++)r[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new z;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new z;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new z;return this.hasError?(t.error(this.thrownError),p.EMPTY):this.isStopped?(t.complete(),p.EMPTY):(this.observers.push(t),new H(this,t))},e.prototype.asObservable=function(){var t=new _;return t.source=this,t},e.create=function(t,e){return new Y(t,e)},e}(_),Y=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return o(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):p.EMPTY},e}(J),W=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return o(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new z;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(J);function G(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new $(t,e))}}var $=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Z(t,this.project,this.thisArg))},t}(),Z=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.project=n,o.count=0,o.thisArg=r||o,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(b);function K(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[m]}(t))return function(t,e){return new _((function(n){var r=new p;return r.add(e.schedule((function(){var o=t[m]();r.add(o.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(L(t))return function(t,e){return new _((function(n){var r=new p;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(B(t))return j(t,e);if(function(t){return t&&"function"==typeof t[T]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new _((function(n){var r,o=new p;return o.add((function(){r&&"function"==typeof r.return&&r.return()})),o.add(e.schedule((function(){r=t[T](),o.add(e.schedule((function(){if(!n.closed){var t,e;try{var o=r.next();t=o.value,e=o.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),o}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}var Q=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(b),X=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(b);function tt(t,e){if(!e.closed)return t instanceof _?t.subscribe(e):R(t)(e)}function et(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(et((function(n,r){return(o=t(n,r),i?K(o,i):o instanceof _?o:new _(R(o))).pipe(G((function(t,o){return e(n,t,r,o)})));var o,i}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new nt(t,n))})}var nt=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new rt(t,this.project,this.concurrent))},t}(),rt=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=n,o.concurrent=r,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new Q(this),n=this.destination;n.add(e);var r=tt(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(X),ot=et;function it(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),et(w,t)}function st(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,o=t[t.length-1];return E(o)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof o&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof _?t[0]:it(n)(k(t,r))}function ut(){return function(t){return t.lift(new ct(t))}}var ct=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new at(t,n),o=e.subscribe(r);return r.closed||(r.connection=n.connect()),o},t}(),at=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return o(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(b),lt=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return o(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new p).add(this.source.subscribe(new ht(this.getSubject(),this))),t.closed&&(this._connection=null,t=p.EMPTY)),t},e.prototype.refCount=function(){return ut()(this)},e}(_),ft=function(){var t=lt.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),ht=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return o(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(U);var pt=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),o=n(r).subscribe(t);return o.add(e.subscribe(r)),o},t}();function dt(){return new J}function yt(){return function(t){return ut()((e=dt,function(t){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof n)return t.lift(new pt(r,n));var o=Object.create(t,ft);return o.source=t,o.subjectFactory=r,o})(t));var e,n}}var bt=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),vt=new _((function(t){return t.complete()}));function mt(t){return t?function(t){return new _((function(e){return t.schedule((function(){return e.complete()}))}))}(t):vt}function wt(t){return function(e){return 0===t?mt():e.lift(new _t(t))}}var gt,_t=function(){function t(t){if(this.total=t,this.total<0)throw new bt}return t.prototype.call=function(t,e){return e.subscribe(new Ot(t,this.total))},t}(),Ot=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return o(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(b),xt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return o(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return o(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return o(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(p))),St=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),Et=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(function(t){function e(n,r){void 0===r&&(r=St.now);var o=t.call(this,n,(function(){return e.delegate&&e.delegate!==o?e.delegate.now():r()}))||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return o(e,t),e.prototype.schedule=function(n,r,o){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,o):t.prototype.schedule.call(this,n,r,o)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(St)))(xt);gt||(gt={});var It=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return N(this.value);case"E":return x(this.error);case"C":return mt()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();var jt=function(t){function e(e,n,r){void 0===r&&(r=0);var o=t.call(this,e)||this;return o.scheduler=n,o.delay=r,o}return o(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new kt(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(It.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(It.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(It.createComplete()),this.unsubscribe()},e}(b),kt=function(){return function(t,e){this.notification=t,this.destination=e}}(),Nt=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var o=t.call(this)||this;return o.scheduler=r,o._events=[],o._infiniteTimeWindow=!1,o._bufferSize=e<1?1:e,o._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(o._infiniteTimeWindow=!0,o.next=o.nextInfiniteTimeWindow):o.next=o.nextTimeWindow,o}return o(e,t),e.prototype.nextInfiniteTimeWindow=function(e){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift(),t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this._events.push(new Pt(this._getNow(),e)),this._trimBufferThenGetEvents(),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),o=this.scheduler,i=r.length;if(this.closed)throw new z;if(this.isStopped||this.hasError?e=p.EMPTY:(this.observers.push(t),e=new H(this,t)),o&&t.add(t=new jt(t,o)),n)for(var s=0;s<i&&!t.closed;s++)t.next(r[s]);else for(s=0;s<i&&!t.closed;s++)t.next(r[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||Et).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,o=r.length,i=0;i<o&&!(t-r[i].time<n);)i++;return o>e&&(i=Math.max(i,o-e)),i>0&&r.splice(0,i),r},e}(J),Pt=function(){return function(t,e){this.time=t,this.value=e}}();function Ct(t,e,n){var r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,r=t.bufferSize,o=void 0===r?Number.POSITIVE_INFINITY:r,i=t.windowTime,s=void 0===i?Number.POSITIVE_INFINITY:i,u=t.refCount,c=t.scheduler,a=0,l=!1,f=!1;return function(t){var r;a++,!e||l?(l=!1,e=new Nt(o,s,c),r=e.subscribe(this),n=t.subscribe({next:function(t){e.next(t)},error:function(t){l=!0,e.error(t)},complete:function(){f=!0,n=void 0,e.complete()}})):r=e.subscribe(this),this.add((function(){a--,r.unsubscribe(),n&&!f&&u&&0===a&&(n.unsubscribe(),n=void 0,e=void 0)}))}}(r))}}var At=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Tt(t,this.total))},t}(),Tt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return o(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(b);function Bt(t,e,n,r){return function(o){return o.lift(new Lt(t,e,n,r))}}var Lt=function(){function t(t,e,n,r){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=r}return t.prototype.call=function(t,e){return e.subscribe(new Rt(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),Rt=function(t){function e(e,n,r,o,i){var s=t.call(this,e)||this;return s.keySelector=n,s.elementSelector=r,s.durationSelector=o,s.subjectSelector=i,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return o(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var r,o=n.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(t){this.error(t)}else r=t;if(!o){o=this.subjectSelector?this.subjectSelector():new J,n.set(e,o);var i=new Ft(e,o,this);if(this.destination.next(i),this.durationSelector){var s=void 0;try{s=this.durationSelector(new Ft(e,o))}catch(t){return void this.error(t)}this.add(s.subscribe(new Dt(e,o,this)))}}o.closed||o.next(r)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,n){e.error(t)})),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(b),Dt=function(t){function e(e,n,r){var o=t.call(this,n)||this;return o.key=e,o.group=n,o.parent=r,o}return o(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(b),Ft=function(t){function e(e,n,r){var o=t.call(this)||this;return o.key=e,o.groupSubject=n,o.refCountSubscription=r,o}return o(e,t),e.prototype._subscribe=function(t){var e=new p,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&e.add(new qt(n)),e.add(r.subscribe(t)),e},e}(_),qt=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return o(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(p);function Mt(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new Vt(t,n,!1,e))}}var Vt=function(){function t(t,e,n,r){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=r}return t.prototype.call=function(t,e){return e.subscribe(new zt(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),zt=function(t){function e(e,n,r,o,i){var s=t.call(this,e)||this;return s.predicate=n,s.source=r,s.yieldIndex=o,s.thisArg=i,s.index=0,s}return o(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,n=this.thisArg,r=this.index++;try{e.call(n||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(b);function Ht(){}function Ut(t,e,n){return function(r){return r.lift(new Jt(t,e,n))}}var Jt=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new Yt(t,this.nextOrObserver,this.error,this.complete))},t}(),Yt=function(t){function e(e,n,r,o){var s=t.call(this,e)||this;return s._tapNext=Ht,s._tapError=Ht,s._tapComplete=Ht,s._tapError=r||Ht,s._tapComplete=o||Ht,i(n)?(s._context=s,s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||Ht,s._tapError=n.error||Ht,s._tapComplete=n.complete||Ht),s}return o(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(b);var Wt=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new Gt(t,this.observables,this.project))},t}(),Gt=function(t){function e(e,n,r){var o=t.call(this,e)||this;o.observables=n,o.project=r,o.toRespond=[];var i=n.length;o.values=new Array(i);for(var s=0;s<i;s++)o.toRespond.push(s);for(s=0;s<i;s++){var u=n[s];o.add(D(o,u,void 0,s))}return o}return o(e,t),e.prototype.notifyNext=function(t,e,n){this.values[n]=e;var r=this.toRespond;if(r.length>0){var o=r.indexOf(n);-1!==o&&r.splice(o,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(P);function $t(t,e){return function(n){return n.lift(new Zt(t,e))}}var Zt=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Kt(t,this.predicate,this.thisArg))},t}(),Kt=function(t){function e(e,n,r){var o=t.call(this,e)||this;return o.predicate=n,o.thisArg=r,o.count=0,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(b);function Qt(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new Xt(t,e,n))}}var Xt=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new te(t,this.accumulator,this.seed,this.hasSeed))},t}(),te=function(t){function e(e,n,r,o){var i=t.call(this,e)||this;return i.accumulator=n,i._seed=r,i.hasSeed=o,i.index=0,i}return o(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(b),ee=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}();function ne(t){return function(e){return 0===t?mt():e.lift(new re(t))}}var re=function(){function t(t){if(this.total=t,this.total<0)throw new bt}return t.prototype.call=function(t,e){return e.subscribe(new oe(t,this.total))},t}(),oe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.ring=new Array,r.count=0,r}return o(e,t),e.prototype._next=function(t){var e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,o=0;o<n;o++){var i=e++%n;t.next(r[i])}t.complete()},e}(b);function ie(t){return void 0===t&&(t=ce),function(e){return e.lift(new se(t))}}var se=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new ue(t,this.errorFactory))},t}(),ue=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return o(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(b);function ce(){return new ee}function ae(t){return void 0===t&&(t=null),function(e){return e.lift(new le(t))}}var le=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new fe(t,this.defaultValue))},t}(),fe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return o(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(b);function he(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?$t((function(e,n){return t(e,n,r)})):w,ne(1),n?ae(e):ie((function(){return new ee})))}}function pe(t){return function(e){return e.lift(new de(t))}}var de=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new ye(t),r=tt(this.notifier,new Q(n));return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n},t}(),ye=function(t){function e(e){var n=t.call(this,e)||this;return n.seenValue=!1,n}return o(e,t),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(X);var be=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ve(t))},t}(),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype._next=function(t){},e}(b),me=n(0);const we=t=>window?new _(e=>{const n=new WebSocket(t,"ritp");n.onclose=function(t){e.error(t.reason)},n.onopen=function(t){n.onclose=null;e.next({send:t=>{console.info("send:",t),n.send(t)},onClose:t=>{n.addEventListener("close",e=>{t(e.reason)})},onBuffer:t=>{n.addEventListener("message",e=>{t(e.data)})},close:()=>{n.close()}}),e.complete()}}):x("no window"),ge=({sockets:t,myInfo:e,remoteInfoMapper:n=N})=>t.pipe(ot(({send:t,onBuffer:n,onClose:r,close:o})=>new _(i=>{r(t=>{i.error(t)});const s=new _(t=>{n(e=>{t.next(e)})}).pipe(yt());return i.next({send:t,buffers:s}),t(me.ritp.PeerInfo.encode(e).finish()),()=>{t(me.ritp.Frame.encode({disconnect:{}}).finish()),o()}})),G(({buffers:t,send:r})=>{const o=t.pipe(wt(1),G(t=>me.ritp.PeerInfo.decode(t))),i=o.pipe(ot(n)),s=q(o,i).pipe(G(([t,n])=>({myInfo:e,remoteInfo:t,mappedInfo:n})),Ct()),u=t.pipe((c=1,function(t){return t.lift(new At(c))}),G(t=>me.ritp.Frame.decode(t)),Bt(t=>t.type));var c;const a=u.pipe(Mt(t=>"event"==t.key),ot(t=>t),G(t=>t.event)).pipe(Bt(t=>t.streamId),ot(t=>{const e=t.key,n=t.pipe(Bt(t=>t.type),Ct()),r=n.pipe(wt(1),ot(t=>"request"==t.key?t:x(new Error("oops!"))),G(t=>t.request)),o=n.pipe(Mt(t=>"chunk"==t.key),ot(t=>t),G(t=>t.chunk)),i=n.pipe(Mt(t=>"end"==t.key),ot(t=>t),G(t=>t.end));return r.pipe(G(t=>({streamId:e,handlerName:t.handlerName,request:t,chunks:o,end:i})))})).pipe(Bt(t=>t.handlerName),Ct()),l=t=>a.pipe(Mt(e=>e.key==t),ot(t=>t)),f=s.pipe(G(t=>({peerContext:t,findStreamsByHandlerName:l,sender:{send:r}}))),h=u.pipe(Mt(t=>"control"==t.key),ot(t=>t),G(t=>t.control)).pipe(Bt(t=>t.streamId),Ct()),p=new W(0),d=q(p.pipe(wt(1),Ut(t=>p.next(t+1))),s).pipe(G(([t,e])=>({peerContext:e,controls:h.pipe(Mt(e=>e.key==t),ot(t=>t)),sendRequest:e=>r(me.ritp.Frame.encode({event:{streamId:t,request:e}}).finish()),sendChunk:e=>r(me.ritp.Frame.encode({event:{streamId:t,chunk:e}}).finish()),sendEnd:e=>r(me.ritp.Frame.encode({event:{streamId:t,end:e}}).finish())})));return{stream:_e(d),register:Oe(f)}})),_e=t=>({request:e,requester:n})=>t.pipe(Ut(({sendRequest:t})=>t(e)),ot(({peerContext:t,controls:r,sendChunk:o,sendEnd:i})=>{const s=new W(0),u=n({peerContext:t,request:e,sendableAmount:s}),c=s.pipe(G(t=>t>0)),a=u.pipe(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new Wt(r,n))}}(c),$t(([t,e])=>e),Ut(([t,e])=>o(t),t=>i({reason:me.ritp.End.Reason.CANCEL,detail:JSON.stringify(t)}),()=>i({reason:me.ritp.End.Reason.FINISH})),Qt((t,e)=>t-1,0),yt()),l=a.pipe(he()),f=r.pipe(Bt(t=>t.type)),h=f.pipe(Mt(t=>"close"==t.key),ot(t=>t),ot(t=>x(t.close))),p=f.pipe(Mt(t=>"pull"==t.key),ot(t=>t),Qt((t,e)=>t+e.pull,0),yt()),d=st(p,a).pipe(Qt((t,e)=>t+e,0),Ut(t=>s.next(t)),pe(h),pe(l)).pipe(he());return p.pipe(pe(d))})),Oe=t=>({handlerName:e,handler:n,bufferSize:r=100})=>t.pipe(ot(({peerContext:t,findStreamsByHandlerName:r,sender:o})=>r(e).pipe(ot(({request:e,chunks:r,streamId:i})=>st(n({peerContext:t,request:e,chunks:r}).pipe(Ut(t=>o.send(me.ritp.Frame.encode({control:{streamId:i,pull:t}}).finish()),t=>o.send(me.ritp.Frame.encode({control:{streamId:i,close:{reason:me.ritp.Close.Reason.APPLICATION_ERROR,detail:JSON.stringify(t)}}}).finish()),()=>o.send(me.ritp.Frame.encode({control:{streamId:i,close:{reason:me.ritp.Close.Reason.ABORT}}}).finish())),(function(t){return t.lift(new be)})),r)))))}])}));